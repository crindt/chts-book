---
title: "3.Diagnostics Checks of the CHTS"
author: "Suman Mitra"
date: "August 31, 2015"
output: html_document
---

# Summary and Methodology

This section explains how to generate summary statistics for the
2010-2012 California Household Travel Survey (2012 CHTS) and how to
compare them with common variables from the 2000-2001 California
Household Travel Survey (2001 CHTS). The 2012 CHTS is comprised of six
main datasets and four additional datasets with location data (x-y
coordinates); the latter were merged with the corresponding main
datasets to check for compatibility. Merging did not create any
problem, and resulted only in two minor discrepancies. First, when we
merged the person-level dataset with the corresponding x-y coordinates
dataset, one observation did not match in the person dataset. Second,
5 observations did not match when we merged the place dataset with the
corresponding x-y coordinates dataset. We checked each variable from
all datasets. To do so, we generated simple summary statistics for all
variables plus boxplots and histograms for selected variables.

Overall, data quality is good.  Key statistics of variables and
graphical checks did not reveal any major flaws. We also did not find
major departures in the summary statistics compared to the 2001 CHTS
data.

The merged household dataset for the 2012 CHTS has 42,431 observations
and 83 variables. Summary statistics, boxplots, and histograms for
selected household variables suggest a few minor problems. First, the
maximum value of `HTRIPS` ("Number of household trips on travel day")
seems high (it is 99 for the 2012 CHTS versus 54 for the 2001
CHTS). Second, the number of observations for `HHNOV`s ("Reasons for
not possessing a vehicle") and for the number of households without a
vehicle should be equal but a cross-check shows that there are 649
missing values in `HHNOV`s. We also found that there are 25 cases for
`LDPER1` ("HH members who completed their long distance travel log")
where long distance logs should have been completed but are not
available.

After the household dataset, we analyze person variables. The merged
person dataset has 149 variables and 109,113 observations.  Two
observations have data for `AGEB` ("Age if refused") even though we
understand they were not supposed to.  Moreover, `TOLLF` ("Did you use
a toll?") and `SLOC` ("Home school") have 221 and 18 missing values
respectively. A few other variables have missing values (number of
values in parenthesis), including "Relationship to head of household"
(1), "Gender" (1), "Hispanic or Latino" (1), "Ethnicity or race" (6),
"Nativity" (1), "Toll pass" (1), "Car sharing" (1), "Employed" (1),
"Disability type" (4), "Transit trips used in the past week" (1),
"Walk in the last week" (1), "Online school" (1), "Pre-school
location" (2), and "Level of education completed" (1). Summary
statistics are presented in Table 2, which is followed by graphical
illustrations of selected variables.

We then consider vehicle data. The vehicle dataset has 79,011
observations and 36 variables. Apart from missing values, there is no
problem with this dataset: there are 49 missing values in `VEHTRN`
("Vehicle transmission"), `VEHDRT` ("Power train, other") and `VEHCYL`
("Cylinders"). Moreover, `FUELT1` ("Fuel type 1") has 15 missing
values, and finally "Vehicle model" and "Series" are missing 1 and 2
values respectively.

The place level dataset has 460,528 observations and 56 variables. In
this dataset, the minimum value for `NONHH` ("Number of non-household
members on trip") is negative, which is not possible. Moreover,
`oXCORD`, `oYCORD`, `dXCORD` and `dYCORD` are not labelled in the
original data frame; we assume that they contain x-y coordinates of origin
and destination places, respectively. In this dataset, the `STATE`
variable has 728 missing values; moreover, `ROUTE` (Transit route),
`PNAME` (Place name) and `CITY` have 1, 1, and 3 missing values,
respectively. There is no substantial difference in key statistics
between the 2012 CHTS and the 2001 CHTS for common place variables.

The activity level dataset has 604,711 observations and 22
variables. Activity variables have no missing values. We note,
however, that `ACTWK` ("Number of people for your work in the
activity"), `ACTSH` ("Number of people for your school"), `ACTRG`
("Number of people from same region/social org"), `ACTFR` ("Number of
friends"), and `ACTOT` ("Number of other relations") have similar
values, which is unexpected.

Finally, we analyze long distance travel variables. The merged dataset
has 68,193 observations and 59 variables. Since there are no long
distance data in the 2001 CHTS, comparison is not possible. We note
625 missing values for `LDOST` ("Origin State") and 809 missing values
for `LDDST` ("Destination state"). Both `LDPNM` ("Origin place name")
and `LDOCTFIP` ("Long distance trip origin location county FIP Code
2010") have one missing value. We find no other concern with long
distance variables.



# R Code and Implementation
The following commands are used for our diagnostics checks of the CHTS.

## Household Data

We first import the household data and corresponding look up data
(that contain x-y coordinates). There are a variety of ways to do
this.  Throughout this document, we will use the CHTS R packages that
we have created and discussed previously.  Here we load the packages
and merge the household data frames, merging the public data `chts_hh`
with the private data containing household coordinates `chts_lu_hh`.

```{r loading-setup,echo=FALSE,cache=TRUE}
if ( !exists("rd") ) { rd <<- gsub("(.*?chts-book[^/]*).*$","\\1",getwd()) } 
source(paste(rd,"R/setup-hooks.R",sep="/"))
write(paste("Using Root Directory",rd,"\n"),stderr())
```


```{r diag-setup,cache=TRUE}
# load the packages
library(chts2011)
library(chts2011pvt)
library(pander)
hhdata <- chts_hh
lookup_hh <- chts_lu_hh

#Merge the two data sets
hhdata1<-merge(hhdata,lookup_hh, by ="SAMPN", all = TRUE)

#Names of the variables in the new dataset
names(hhdata1)

# Check dimension of the data sets
dim(hhdata)
dim(lookup_hh)
dim(hhdata1)
```

We have a merged data frame now, but we need to clean it by deleting
duplicates:

```{r diag-1, cache=TRUE}
# Subset the dataset (excluding the duplicate variables)
nhhdata<-subset(hhdata1,select=-c(HCITY.x,HZIP.x,HXCORD.x,HYCORD.x,HPrimaryCity.x))

# Dimension of new dataset
dim(nhhdata)

# Names of the variables of the new data set
names(nhhdata)

# rename the added variables
names(nhhdata)[c(76,77,78,79,83)]<-c("HCITY","HZIP","HXCORD","HYCORD","HPrimaryCity")

# Names of the variables
names(nhhdata)
```


Now we have a new merged data frame that we can use for diagnostics checks
of the household data.  Here, we "attach" the data frame to the
workspace, which makes each of its columns accessible as a standalone
variable meaning, for example, that we can reference the sample number as
`SAMPN` rather than `nhhdata$SAMPN`.  This isn't completely necessary,
but it makes the code look a little cleaner.

```{r diag-2, cache=TRUE}
# Attach the data frame
attach(nhhdata) 
```

We check variables one by one starting with the sample number.

```{r diag-summary-sampn,echo=FALSE,cache=TRUE,results='asis'}
#### SAMPN
var.value.summary('SAMPN',val.list=FALSE)
```



```{r diag-3, cache=TRUE}
# Sorting data by sample number
## SAMPN:Sample Number
nhhdata<-nhhdata[order(SAMPN),]

## Summary statistics
summary(SAMPN)
## standard deviation
sd(SAMPN)
## boxplot
boxplot(SAMPN)

```



```{r diag-summary-recmode,echo=FALSE,cache=TRUE,results='asis'}
#### RECMODE
var.value.summary('RECMODE')
```



```{r diag-4, cache=TRUE}
### Show the first 10 observations
head (RECMODE,10)
###Summarize the variable
summary(RECMODE)
sd(RECMODE)
### Create graph
### box plots
boxplot(RECMODE,xlab=c("Recruit mode"),col=c("gold"))
## bar plot
counts <- table(RECMODE)
barplot(counts, 
        xlab="Recruit mode (1=CATI;2=CAWI)",
        ylim=c(0,40000),
        ylab="Frequency",
        col="green")
### Check missing observations
sum(RECMODE=="")
sum(is.na(RECMODE))

```

We repeat the same procedure for the other household variables.


```{r diag-summary-retmode,echo=FALSE,cache=TRUE,results='asis'}
#### RETMODE
var.value.summary('RETMODE')
```


```{r diag-5, cache=TRUE}
## RETMODE
head (RETMODE,10)
summary(RETMODE)
sd(RETMODE)
boxplot(RETMODE,xlab=c("Retrieval mode"),col=c("gold"))
counts <- table(RETMODE)
barplot(counts, 
        xlab="Retrieval mode (1=CATI;2=CAWI;3=Mail back)",
        ylim=c(0,20000),
        ylab="Frequency",
        col="gold")
sum(RETMODE=="")
sum(is.na(RETMODE))

```



```{r diag-summary-incen,echo=FALSE,cache=TRUE,results='asis'}
#### INCEN
var.value.summary('INCEN')
```

```{r diag-6, cache=TRUE}
## INCEN
head (INCEN,10)
summary(INCEN)
sd(INCEN)
counts <- table(INCEN)
barplot(counts, 
        xlab="Incentive flag (1:Yes; 2=No)",
        ylim=c(0,25000),
        ylab="Frequency",
        col="blue1")
boxplot(INCEN,xlab=c("Incentive flag"),col=c("green"))
sum(INCEN=="")
sum(is.na(INCEN))

```



```{r diag-summary-ilang,echo=FALSE,cache=TRUE,results='asis'}
#### ILANG
var.value.summary('ILANG')
```


```{r diag-7, cache=TRUE}
## ILANG 
head(ILANG,10)
summary(ILANG)
sd(ILANG)
counts <- table(ILANG)
barplot(counts, 
        xlab="Interview language (1:English; 2= Spanish)",
        ylim=c(0,40000),ylab="Frequency",col="light green")
boxplot(ILANG,xlab=c("Interview language"),col=c("green"))
sum(ILANG=="")
sum(is.na(ILANG))
```



```{r diag-summary-ctfip,echo=FALSE,cache=TRUE,results='asis'}
#### CTFIP
var.value.summary('CTFIP',val.list=FALSE)
```



```{r diag-8, cache=TRUE}
## CTFIP
head (CTFIP,10)
summary(CTFIP)
sd(CTFIP)
boxplot(as.integer(CTFIP),xlab=c("Residential county"),col=c("gold"))
###Check missing values
sum(CTFIP=="")
sum(is.na(CTFIP))
```



```{r diag-summary-area,echo=FALSE,cache=TRUE,results='asis'}
#### AREA
var.value.summary('AREA')
```



```{r diag-9, cache=TRUE}
## AREA
head(AREA,10)
summary(AREA)
sd(AREA)
boxplot(AREA,xlab=c("AREA:MPO"),col=c("green"))
### Check missing values
sum(AREA=="")
sum(is.na(AREA))
```


```{r diag-summary-strata,echo=FALSE,cache=TRUE,results='asis'}
#### STRATA
var.value.summary('STRATA',val.list=FALSE)
```



```{r diag-10, cache=TRUE}
## STRATA
head (STRATA,10)
summary(STRATA)
sd(STRATA)
boxplot(STRATA,xlab=c("Strata"),col=c("yellow"))
sum(STRATA=="")
sum(is.na(STRATA))
```



```{r diag-summary-stype,echo=FALSE,cache=TRUE,results='asis'}
#### STYPE
var.value.summary('STYPE')
```



```{r diag-11, cache=TRUE}
## STYPE
head(STYPE,10)
summary(STYPE)
sd(STYPE)
boxplot(STYPE,xlab=c("Sample Type"),col=c("yellow"))
counts <- table(STYPE)
barplot(counts, 
        xlab="Sample type (1=Matched;2=Unmatched)",
        ylim=c(0,40000),ylab="Frequency",col="blue1")
sum(STYPE=="")
sum(is.na(STYPE))
```




```{r diag-summary-cec,echo=FALSE,cache=TRUE,results='asis'}
#### CEC
var.value.summary('CEC')
```


```{r diag-12, cache=TRUE}
## CEC
head (CEC,10)
summary(CEC)
boxplot(CEC,xlab=c("CEC sample flag"),col=c("yellow"))
sd(CEC,na.rm=T)
sum(is.na(CEC))
```


```{r diag-summary-gtype,echo=FALSE,cache=TRUE,results='asis'}
#### GTYPE
var.value.summary('GTYPE')
```


```{r diag-13, cache=TRUE}
## GTYPE
head (GTYPE,10)
summary(GTYPE)
sd(GTYPE)
boxplot(GTYPE,xlab=c("GTYPE: GPS sample type"),col=c("yellow"))
sum(GTYPE=="")
sum(is.na(GTYPE))
```

```{r diag-summary-gflag,echo=FALSE,cache=TRUE,results='asis'}
#### GFLAG
var.value.summary('GFLAG')
```


```{r diag-14, cache=TRUE}
## GFLAG
head(GFLAG,10)
summary(GFLAG)
sd(GFLAG,na.rm=T)
boxplot(GFLAG,xlab=c("GPS type"),col=c("gold"))
sum(is.na(GFLAG)&GTYPE==1)
```



```{r diag-summary-RIBUS,echo=FALSE,cache=TRUE,results='asis'}
#### RIBUS
var.value.summary('RIBUS')
```



```{r diag-15, cache=TRUE}
attach(nhhdata)
```

```{r diag-16, cache=TRUE}
## RIBUS
head (RIBUS,10)
summary (RIBUS[RIBUS<8])
sd(RIBUS)
# Boxplot
boxplot(RIBUS[RIBUS<8],
        xlab=c("Transit use at least once a week"),col=c("gold"))
# Histogram
hist(RIBUS[RIBUS<8],breaks=c(0,1,2),
     xlab=c("1=Yes;2=No;8=DK;9=RF"),xaxt="n",
     ylim=c(0,35000),col=c("green"))
axis(1,xaxp=c(1,2,1),las=2)
###Check missing observations
sum(RIBUS=="")
sum(is.na(RIBUS))
```



```{r diag-summary-HHVEH,echo=FALSE,cache=TRUE,results='asis'}
#### HHVEH
var.value.summary('HHVEH')
```



```{r diag-17, cache=TRUE}
## HHVEH
head(HHVEH,10)
summary(HHVEH[HHVEH<98])
sd(HHVEH[HHVEH<98])
boxplot(HHVEH[HHVEH<98],xlab=c("Number of household vehicles"),col=c("gold"))
hist(HHVEH[HHVEH<98],xlab=c("Number of household vehicles"),col=c("green"))
hist(HHVEH,xlab=c("Number of household vehicles"),xaxt="n",col=c("green"))
axis(1,xaxp=c(1,8,1),las=2)
axis(1, at=seq(0,8, by=1), las=2)
sum(is.na(HHVEH))
sum(HHVEH=="")
```



```{r diag-summary-HHBIC,echo=FALSE,cache=TRUE,results='asis'}
#### HHBIC
var.value.summary('HHBIC')
```

```{r diag-18, cache=TRUE}
## HHBIC
head(HHBIC,10)
summary(HHBIC[HHBIC<98])
sd(HHBIC[HHBIC<98])
boxplot(HHBIC[HHBIC<98],xlab=c("Number of household bicycles"),col=c("green"))
hist(HHBIC[HHBIC<98],xlab=c("Number of household bicycles"),col=c("gold"))
hist(HHBIC[HHBIC<98],xlab=c("Number of household bicycles"),xaxt="n",col=c("gold"))
axis(1,xaxp=c(1,15,1),las=2)
axis(1, at=seq(0,15, by=1), las=2)
boxplot(HHBIC[HHBIC<20], xlab=c("HHBIC"))
sum(is.na(HHBIC))
sum(HHBIC=="")
```

Here, we check observations with many household vehicles

```{r diag-19, cache=TRUE}
### Check the number of observations with HHBIC>=10
sum(HHBIC>=10)
SAMPN[HHBIC>=10]
```



```{r diag-summary-VEHNEW,echo=FALSE,cache=TRUE,results='asis'}
#### VEHNEW
var.value.summary('VEHNEW')
```

```{r diag-20, cache=TRUE}
## VEHNEW
head(VEHNEW,10)
summary(VEHNEW[VEHNEW<8])
sd(VEHNEW)
boxplot(VEHNEW,xlab=c("New vehicle"),col=c("green"))
sum(is.na(VEHNEW))
sum(VEHNEW=="")
```



### Buyer Variables

There are 8 BUYER variables. The following codes are used to check all the BUYER variables. 

```{r diag-21, cache=TRUE}
## BUYER1
head(BUYER1,10)
summary(BUYER1[BUYER1<98])
sd(BUYER1,na.rm=T)
boxplot(BUYER1, xlab=c("BUYER1"))
```

We know that there should be no observations for BUYER variables if VEHNEW==2 and we cross check this:
 
```{r diag-22, cache=TRUE}
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER1))
ind[is.na(ind)]<-F
SAMPN[ind]
```

We repeat this procedure for other BUYER variables:

```{r diag-23, cache=TRUE}
## BUYER2: Buyer 2 (1 to 9 and 98=DK;99=RF)
head(BUYER2,10)
summary(BUYER2[BUYER2<98])
sd(BUYER2,na.rm=T)
boxplot(BUYER2, xlab=c("Buyer 2"))
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER2))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER3: Buyer 3 (1 to 9 and 98=DK;99=RF)
head(BUYER3,10)
sd(BUYER3,na.rm=T)
summary(BUYER3)
boxplot(BUYER3,xlab=c("BUYER3"))
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER3))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER4: Buyer 4 (1 to 9 and 98=DK;99=RF)
head(BUYER4,10)
summary(BUYER4)
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER4))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER5: Buyer 5 (1 to 9 and 98=DK;99=RF)
head(BUYER5,10)
summary(BUYER5)
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER5))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER6: Buyer 6 (1 to 9 and 98=DK;99=RF)
head(BUYER6,10)
summary(BUYER6)
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER6))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER7: Buyer 7 (1 to 9 and 98=DK;99=RF)
head(BUYER7,10)
summary(BUYER7)
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER7))
ind[is.na(ind)]<-F
SAMPN[ind]
## BUYER8: Buyer 8 (1 to 9 and 98=DK;99=RF)
head(BUYER8,10)
summary(BUYER8)
### Cross check the data 
ind<-(VEHNEW==2 & !is.na(BUYER8))
ind[is.na(ind)]<-F
SAMPN[ind]
```



```{r diag-summary-RESTY,echo=FALSE,cache=TRUE,results='asis'}
#### RESTY
var.value.summary('RESTY')
```



```{r diag-24, cache=TRUE}
## RESTY
head(RESTY,10)
summary(RESTY[RESTY<97])
sd(RESTY)
boxplot(RESTY,xlab=c("RESTY"))
sum(is.na(RESTY))
sum(RESTY=="")
## O_RESTY: Description of home-Other
head(O_RESTY,10)
summary(O_RESTY)
```

We know from the CHTS report (see appendix) that there should be no observation in O_RESTY when RESTY is not 97 (others). Let us check it:

```{r diag-25, cache=TRUE}
### Check 
sum(!is.na(O_RESTY) & RESTY==!97)
```



```{r diag-summary-OWN,echo=FALSE,cache=TRUE,results='asis'}
#### OWN
var.value.summary('OWN')
```



```{r diag-26, cache=TRUE}
## OWN
head(OWN,10)
summary(OWN[OWN<8])
sd(OWN)
boxplot(OWN,xlab=c("OWN"))
## O_OWN: Home ownership-other
head(O_OWN,10)
```

We also know that there should be no observation in O_own when OWN is not 7. Let us check it:

```{r diag-27, cache=TRUE}
### Check 
sum(!is.na(O_OWN) & RESTY==!7)
```



```{r diag-summary-TEN,echo=FALSE,cache=TRUE,results='asis'}
#### TEN
var.value.summary('TEN')
```



```{r diag-28, cache=TRUE}
## TEN 
head(TEN,10)
summary(TEN[TEN<98])
sd(TEN[TEN<98])
boxplot(TEN[TEN<98],xlab=c("Tenure"),col=c("gold"))
hist(TEN[TEN<98],xlab=c("Tenure"),ylim=c(0,10000),col=c("green"))
sum(is.na(TEN))
sum(TEN=="")
```


We know from the CHTS data that there should be previous address information if the TEN variable is greater than 6. Let us check this:

```{r diag-29, cache=TRUE}
## PREVCITY
head(PREVCITY,10)
### Check whether there is any PREVCITY observation when TEN>6 (suppose ot be zero))
sum(TEN>6 & !PREVCITY=="",na.rm=T)
## PREVSTAT: Previous address state
head(PREVSTAT,10)
### Check whether there is any PREVSTAT observation when TEN>6(suppose to be zero))
sum(TEN>6 & !PREVSTAT=="")
## PREVSTAT: Previous address state
head(PREVSTAT,10)
### Check whether there is any PREVSTAT observation when TEN>6(suppose to be zero))
sum(TEN>6 & !PREVSTAT=="")
## PREVZIP: Previous address zipcode
head(PREVZIP,10)
summary(PREVZIP,na.rm=T)
### Check whether there is any PREVZIP observation when TEN>6(suppose to be zero))
sum(TEN>6 & !PREVZIP=="")
```



```{r diag-summary-PHLNS,echo=FALSE,cache=TRUE,results='asis'}
#### PHLNS
var.value.summary('PHLNS')
```



```{r diag-30, cache=TRUE}
## PHLNS
head(PHLNS,10)
summary(PHLNS[PHLNS<98])
sd(PHLNS[PHLNS<98])
boxplot(PHLNS[PHLNS<98],xlab=c("Number of land line phones"),col=c("gold"))
hist(PHLNS[PHLNS<98],xlab=c("Number of land line phones"),col=c("gold"))
```



```{r diag-summary-INCOM,echo=FALSE,cache=TRUE,results='asis'}
#### INCOM
var.value.summary('INCOM')
```


```{r diag-31, cache=TRUE}
attach(nhhdata)
```

```{r diag-32, cache=TRUE}
## INCOM:Household income (1 to 10;98=DK;99=RF)
head(INCOM,10)
summary(INCOM[INCOM<98])
sd(INCOM)
boxplot(INCOM,xlab=c("Household income "),col=c("green"))
hist(INCOM[INCOM<15],xlab=c("Household income"),xaxt="n",ylim=c(0,8000),col=c("gold"))
axis(1, at=seq(0,10, by=1), las=2)
sum(is.na(INCOM))
sum(INCOM=="")
```



```{r diag-summary-HHSIZ,echo=FALSE,cache=TRUE,results='asis'}
#### HHSIZ
var.value.summary('HHSIZ')
```



```{r diag-33, cache=TRUE}
## HHSIZ
head(HHSIZ,10)
summary(HHSIZ[HHSIZ<98])
sd(HHSIZ[HHSIZ<98])
boxplot(HHSIZ,xlab=c("Household size"),col=c("gold"))
hist(HHSIZ,xlab=c("Household size"),col=c("green"))
axis(1, at=seq(0,10, by=1), las=2)
sum(is.na(HHSIZ))
sum(HHSIZ=="")
```


Now let us find the number of households with a household size greater >5 and the mean household size when household trips >30:

```{r diag-34, cache=TRUE}
### Check HHSIZ>5
sum(HHSIZ>5)
### Mean
mean(HHSIZ[HTRIPS>30])
```



```{r diag-summary-NONRELAT,echo=FALSE,cache=TRUE,results='asis'}
#### NONRELAT
var.value.summary('NONRELAT')
```



```{r diag-35, cache=TRUE}
## NONRELAT
head(NONRELAT,10)
summary(NONRELAT)
sd(NONRELAT,na.rm=T)
boxplot (NONRELAT,xlab=c("NONRELAT"))
```



```{r diag-summary-HHEMP,echo=FALSE,cache=TRUE,results='asis'}
#### HHEMP
var.value.summary('HHEMP',val.list=FALSE)
```



```{r diag-36, cache=TRUE}
## HHEMP
head(HHEMP,10)
summary(HHEMP)
sd(HHEMP)
boxplot(HHEMP,xlab=c("Number of household workers"),col=c("yellow"))
hist(HHEMP,xlab=c("Number of household workers"),col=c("sky blue"))
sum(is.na(HHEMP))
sum(HHEMP=="")
### Households with HHEMP>3
sum(HHEMP>3)
```



```{r diag-summary-HHSTU,echo=FALSE,cache=TRUE,results='asis'}
#### HHSTU
var.value.summary('HHSTU',val.list=FALSE)
```



```{r diag-37, cache=TRUE}
## HHSTU
head(HHSTU,10)
summary(HHSTU)
sd(HHSTU)
boxplot(HHSTU,xlab=c("Number of household students"),col=c("gold"))
hist(HHSTU,xlab=c("Number of household students"),col=c("green"))
sum(is.na(HHSTU))
sum(HHSTU=="")
```

The number of household students cannot exceed the household size. Let us check it:

```{r diag-38, cache=TRUE}
### Check observations with number of students>=6 and household size >=6)
sum(HHSTU>=6&HHSIZ>=6)
###Checke HHSTU>HHSIZ
sum(HHSTU>HHSIZ)
```



```{r diag-summary-HHLIC,echo=FALSE,cache=TRUE,results='asis'}
#### HHLIC
var.value.summary('HHLIC',val.list=FALSE)
```



```{r diag-39, cache=TRUE}
## HHLIC
head (HHLIC,10)
summary(HHLIC)
boxplot(HHLIC,xlab=c("Number of household driver license holders"),col=c("green"))
hist(HHLIC,xlab=c("Number of household driver license holders"),col=c("gold"))
sd(HHLIC)
sum(is.na(HHLIC))
sum(HHLIC=="")
```

As for the nubmer of students in the household, HHLIC can't exceed household size. Let us check it: 

```{r diag-40, cache=TRUE}
###To check whether HHLIC>HHSIZ
sum(HHLIC>HHSIZ)
```




```{r diag-summary-RECDate,echo=FALSE,cache=TRUE,results='asis'}
#### RECDate
var.value.summary('RECDate',val.list=FALSE)
```


```{r diag-41, cache=TRUE}
## RECDate
head(RECDate,10)
summary(RECDate)
sum(is.na(RECDate))
#sum(RECDate=="")
```



```{r diag-summary-ASSN,echo=FALSE,cache=TRUE,results='asis'}
#### ASSN
var.value.summary('ASSN',val.list=FALSE)
```



```{r diag-42, cache=TRUE}
## ASSN
head(ASSN,10)
sum(is.na(ASSN))
sum(ASSN=="")
```



```{r diag-summary-DOW,echo=FALSE,cache=TRUE,results='asis'}
#### DOW
var.value.summary('DOW')
```



```{r diag-43, cache=TRUE}
## DOW
head(DOW,10)
summary(DOW)
sd(DOW)
boxplot(DOW,xlab=c("Assigned travel day"),col=c("green"))
hist(DOW,xlab=c("Assigned travel day"),col=c("light blue"))
sum(is.na(DOW))
sum(DOW=="")
```



```{r diag-summary-HTRIPS,echo=FALSE,cache=TRUE,results='asis'}
#### HTRIPS
var.value.summary('HTRIPS',val.list=FALSE)
```



```{r diag-44, cache=TRUE}
## HTRIPS: Number of household trips on travel day
head (HTRIPS,10)
summary(HTRIPS)
sd(HTRIPS)
boxplot(HTRIPS,xlab=c("Number of household trips on travel day"),col=c("red"))
hist(HTRIPS[HTRIPS<65],xaxt="n",yaxt="n", 
     xlab=c("Number of household trips on travel day"),col=c("yellow"))
axis(1, at=seq(0,60, by=5), las=2)
axis(2, at=seq(0,30000, by=2500), las=1, cex.axis=0.8)
sum(is.na(HTRIPS))
sum(HTRIPS=="")
```

Here, let us look at observations with a high number of household trips:

```{r diag-45, cache=TRUE}
###NUmber of household trips>20, >30, >90
sum(HTRIPS>20)
sum(HTRIPS>30)
sum(HTRIPS>90)
### Observations which have HTRIPS>90
SAMPN[HTRIPS>90]
```

Let us now check all the home location variables:

```{r diag-46, cache=TRUE}
## HCITY: Home city
head(HCITY,10)
sum(is.na(HCITY))
sum(HCITY=="")

##HZIP: Home zip
head(HZIP,10)
summary(HZIP)
sum(is.na(HZIP))
sum(HZIP=="")

##HXCORD: Home x-coordinate
head(HXCORD,10)
summary(HXCORD)
sd(HXCORD)
sum(is.na(HXCORD))
sum(HXCORD=="")

##HYCORD: Home Y-coordinate
head(HYCORD,10)
summary(HYCORD)
sd(HYCORD)
sum(is.na(HYCORD))
sum(HXCORD=="")
```


There are eight variables for HHNOVs (reason of no possession of vehicle). Let us go through them:


```{r diag-47, cache=TRUE}
#### HHNOV1: Reason of no possession of vehicle1 (1 to 12;98=DK;99=RF)
head(HHNOV1,10)
summary(HHNOV1[HHNOV1<98],na.rm=T)
sd(HHNOV1,na.rm=T)
boxplot(HHNOV1,xlab=c("HHNOV1"))
## HHNOV2: Reason of no possession of vehicle2 (1 to 12;98=DK;99=RF)
head(HHNOV2,10)
summary(HHNOV2)
sd(HHNOV2,na.rm=T)
boxplot(HHNOV2,xlab=c("HHNOV2"))
## HHNOV3: Reason of no possession of vehicle3 (1 to 12;98=DK;99=RF)
head(HHNOV3,10)
summary(HHNOV3)
sd(HHNOV3,na.rm=T)
boxplot(HHNOV3,xlab=c("HHNOV3"))
## HHNOV4: Reason of no possession of vehicle4 (1 to 12;98=DK;99=RF)
head(HHNOV4,10)
summary(HHNOV4)
sd(HHNOV4,na.rm=T)
boxplot(HHNOV4,xlab=c("HHNOV4"))
## HHNOV5: Reason of no possession of vehicle5 (1 to 12;98=DK;99=RF)
head(HHNOV5,10)
summary(HHNOV5)
sd(HHNOV5,na.rm=T)
boxplot(HHNOV5,xlab=c("HHNOV5"))
## HHNOV6: Reason of no possession of vehicle6 (1 to 12;98=DK;99=RF)
head(HHNOV6,10)
summary(HHNOV6)
sd(HHNOV6,na.rm=T)
boxplot(HHNOV6,xlab=c("HHNOV6"))
## HHNOV7: Reason of no possession of vehicle7 (1 to 12;98=DK;99=RF)
head(HHNOV7,10)
summary(HHNOV7)
sd(HHNOV7,na.rm=T)
boxplot(HHNOV7,xlab=c("HHNOV7"))
## HHNOV8: Reason of no possession of vehicle8 (1 to 12;98=DK;99=RF)
head(HHNOV8,10)
summary(HHNOV8)
sd(HHNOV8,na.rm=T)
boxplot(HHNOV8,xlab=c("HHNOV8"))
```


We also check whether there is any missing value in HHNOV variables. The number of observations for HHNOV variables should equals the number of households without vehicles. Let us check: 


```{r diag-48, cache=TRUE}
### Check for huseholds without vehicle
sum(HHVEH==0)
### Number of observations for HHNOV should equal the number of households without vehicles
sum(HHVEH==0 & !is.na(HHNOV1) | !is.na(HHNOV2) | !is.na(HHNOV3) | 
      !is.na(HHNOV4) | !is.na(HHNOV5) | !is.na(HHNOV6) | !is.na(HHNOV7) | 
      !is.na(HHNOV8))
sum(HHVEH==0 & is.na(HHNOV1) & is.na(HHNOV2) & is.na(HHNOV3) & 
      is.na(HHNOV4) & is.na(HHNOV5) & is.na(HHNOV6) & is.na(HHNOV7) & 
      is.na(HHNOV8))
#### Show missing observations
SAMPN[HHVEH==0 & is.na(HHNOV1) & is.na(HHNOV2) & is.na(HHNOV3) & 
        is.na(HHNOV4) & is.na(HHNOV5) & is.na(HHNOV6) & is.na(HHNOV7) & 
        is.na(HHNOV8)]
```


```{r diag-summary-VEHOP,echo=FALSE,cache=TRUE,results='asis'}
#### VEHOP
var.value.summary('VEHOP')
```


```{r diag-49, cache=TRUE}
## VEHOP
head(VEHOP,10)
summary(VEHOP[VEHOP<98])
sd(VEHOP[VEHOP<98],na.rm=T)
boxplot(VEHOP[VEHOP<98],xlab=c("Number of operational household vehicles"),col=c("magenta"))
hist(VEHOP,xlab=c("Number of operational household vehicles (Range:0-15;98=DK;99=RF)"),col=c("sky blue"))
boxplot(VEHOP,xlab=c("VEHOP"))
```



```{r diag-summary-VEHPR,echo=FALSE,cache=TRUE,results='asis'}
#### VEHPR
var.value.summary('VEHPR')
```



```{r diag-50, cache=TRUE}
## VEHPR
head(VEHPR,10)
summary(VEHPR[VEHPR<98])
sd(VEHPR[VEHPR<98],na.rm=T)
boxplot(VEHPR[VEHPR<98],xlab=c("Number of vehicles with power outlets"),col=c("lawngreen"))
hist(VEHPR,xlab=c("Number of vehicles with power outlets (Range:0-15;98=DK;99=RF)"),col=c("lawngreen"))
```



```{r diag-summary-VEDTE,echo=FALSE,cache=TRUE,results='asis'}
#### VEDTE
var.value.summary('VEDTE')
```



```{r diag-51, cache=TRUE}
## VEDTE
head(VEDTE,10)
summary(VEDTE)
sd(VEDTE,na.rm=T)
boxplot(VEDTE,xlab=c("Number of newer vehicles with power outlets"),col=c("lawngreen"))
hist(VEDTE,xlab=c("Number of newer vehicles with power outlets (Rangle:0-15)"),col=c("maroon"))
### Check whether there is any VEDTE observation without VEHPR>0 and GFLAG=3 
### (HHNOV))
sum(!is.na(VEDTE)&!VEHPR>0&!GFLAG==3)
```

There are 9 variables related to long distance log completion. Let us check all these variables: 

```{r diag-52, cache=TRUE}
## CMPLD: Complete long distance log (1=yes;2=no;3=did not recieve;8=DK;9=RF)
head(CMPLD,10)
summary(CMPLD[CMPLD<8])
sd(CMPLD,na.rm=T)
boxplot(CMPLD,xlab=c("CMPLD"))
sum(is.na(CMPLD))
##LDPER1: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER1,10)
summary(LDPER1[LDPER1<98])
sd(LDPER1,na.rm=T)
###Check is there any LDPER1 when CMPLD is no
sum(!is.na(LDPER1)&!CMPLD==1)
##LDPER2: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER2,10)
summary(LDPER2)
###Check is there any LDPER2 when CMPLD is no
sum(!is.na(LDPER2)&!CMPLD==1)
##LDPER3: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER3,10)
summary(LDPER3)
###Check is there any LDPER3 when CMPLD is no
sum(!is.na(LDPER3)&!CMPLD==1)
##LDPER4: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER4,10)
summary(LDPER4)
###Check is there any LDPER4 when CMPLD is no
sum(!is.na(LDPER4)&!CMPLD==1)
##LDPER5: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER5,10)
summary(LDPER5)
###Check is there any LDPER5 when CMPLD is no
sum(!is.na(LDPER5)&!CMPLD==1)
##LDPER6: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER6,10)
summary(LDPER6)
###Check is there any LDPER6 when CMPLD is no
sum(!is.na(LDPER6)&!CMPLD==1)
##LDPER7: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER7,10)
summary(LDPER7)
###Check is there any LDPER7 when CMPLD is no
sum(!is.na(LDPER7)&!CMPLD==1)
##LDPER8: HH member who completed LD log (Range:1-8;98=DK;99=RF)
head(LDPER8,10)
summary(LDPER8)
###Check is there any LDPER8 when CMPLD is no
sum(!is.na(LDPER8)&!CMPLD==1)
```



```{r diag-summary-LDTRP,echo=FALSE,cache=TRUE,results='asis'}
#### LDTRP
var.value.summary('LDTRP')
```



```{r diag-53, cache=TRUE}
## LDTRP
head(LDTRP,10)
summary(LDTRP[LDTRP<8])
sd(LDTRP)
boxplot(LDTRP,xlab=c("LDTRP"))
sum(is.na(LDTRP))
```



```{r diag-summary-LDFlag,echo=FALSE,cache=TRUE,results='asis'}
#### LDFlag
var.value.summary('LDFlag')
```


```{r diag-54, cache=TRUE}
## LDFlag
head(LDFlag,10)
summary(LDFlag)
sd(LDFlag,na.rm=T)
```

The long distance flag should be zero when no trip is reported for long distance:

```{r diag-55, cache=TRUE}
### Check whether all LD Flag=1 when LDTRP>0
sum(LDFlag==1,na.rm=T)
sum(LDFlag==1& LDTRP>0,na.rm=T)
```



```{r diag-summary-HH_Complete,echo=FALSE,cache=TRUE,results='asis'}
#### HH_Complete
var.value.summary('HH_Complete')
```


```{r diag-56, cache=TRUE}
## HH_Complete
head(HH_Complete,10)
summary(HH_Complete)
sd(HH_Complete,na.rm=T)
sum(is.na(HH_Complete))
```

```{r diag-summary-GPS_Complete,echo=FALSE,cache=TRUE,results='asis'}
#### GPS_Complete
var.value.summary('GPS_Complete')
```


```{r diag-57, cache=TRUE}
head(GPS_Complete,10)
summary(GPS_Complete)
sd(GPS_Complete,na.rm=T)
```



```{r diag-summary-HCTRACT,echo=FALSE,cache=TRUE,results='asis'}
#### HCTRACT
var.value.summary('HCTRACT',val.list=FALSE)
```



```{r diag-58, cache=TRUE}
## HCTRACT
head(HCTRACT,10)
summary(HCTRACT)
sd(HCTRACT,na.rm=T)
sum(is.na(HCTRACT))
```



```{r diag-summary-HPrimaryCity,echo=FALSE,cache=TRUE,results='asis'}
#### HPrimaryCity
var.value.summary('HPrimaryCity',val.list=FALSE)
```


```{r diag-59, cache=TRUE}
## HPrimaryCity
head(HPrimaryCity,10)
sum(is.na(HPrimaryCity))
```



```{r diag-summary-HHWGT,echo=FALSE,cache=TRUE,results='asis'}
#### HHWGT
var.value.summary('HHWGT',val.list=FALSE)
```

```{r diag-60, cache=TRUE}
##HHWGT
head(HHWGT,10)
summary(HHWGT)
sd(HHWGT)
boxplot(HHWGT,xlab=c("Final household weight"),col=c("gold"))
sum(is.na(HHWGT))
```



```{r diag-summary-EXPHHWGT,echo=FALSE,cache=TRUE,results='asis'}
#### EXPHHWGT
var.value.summary('EXPHHWGT',val.list=FALSE)
```



```{r diag-61, cache=TRUE}
## EXPHHWGT
head(EXPHHWGT,10)
summary(EXPHHWGT)
sd(EXPHHWGT)
boxplot(EXPHHWGT,xlab=c("Final expanded household weight"),col=c("green"))
sum(is.na(EXPHHWGT))
```


We are done with our diagnostic checks of the household data. Now we need to detach the household data frame.


```{r diag-62, cache=TRUE}
# Detach the data frame
detach(nhhdata)
```



## Person Data

To examine person data, we again rely on the R packages
containing the CHTS datasets.  We have already loaded the `chts2011`
packages so can directly access the person-related data frames
`chts_per` and `chts_lu_per`.

```{r diag-63, cache=TRUE}
persondata <- chts_per
lookup_per <- chts_lu_per

#Check the names of the variables
names(persondata)
names(lookup_per)

#Merge the two data sets
perdata1<-merge(persondata,lookup_per, by =c("SAMPN", "PERNO"), all = TRUE)

#Names of the variables in the new dataset
names(perdata1)
```

There are a few duplicate variables that need to be deleted from the new data frame.

```{r diag-64, cache=TRUE}
# Subset the dataset (exclude duplicate variables)
npersondata <- subset(
  perdata1,
  select=-c(38,39,41,42,43,44,45,61,63,64,66,67,68,95,96,98,99,100,101,102,137:146))

#Dimension of the new dataset
dim(npersondata)

#Names of the variables
names(npersondata)

#rename the added variables
names(npersondata)[c(119:146,148,149)] <- c(
  "WNAME","WCITY","WZIP","WXST1","WXST2","WXCORD","WYCORD","WNAME2","WCITY2",
  "WZIP2","WXST2_1","WXST2_2","SNAME","SCITY","SZIP","SXST1","SXST2","SXCORD",
  "SYCORD", "WCTFIP","WTRACT","WBLOCK","WPrimaryCity","WSTFIP","W2PrimaryCity",
  "W2STFIP","SCTFIP","STRACT","SPrimaryCity","SSTFIP")

#Names of the variables
names(npersondata)
```

Now we have a new merged data frame that we can use for diagnostics checks of the person level data. First, we attach this data frame:

```{r diag-65, cache=TRUE}
# Attach the data frame
attach(npersondata)
```

We check the variables one by one starting with sample number and person number:

```{r diag-summary-SAMPN,echo=FALSE,cache=TRUE,results='asis'}
#### SAMPN
var.value.summary('SAMPN',tab='per',val.list=FALSE)
```

```{r diag-66, cache=TRUE}
## SAMPN
summary(SAMPN)
sd(SAMPN)
```

```{r diag-summary-PERNO,echo=FALSE,cache=TRUE,results='asis'}
#### PERNO
var.value.summary('PERNO',tab='per',val.list=FALSE)
```


```{r diag-66b, cache=TRUE}
#PERNO:Person Number
head(PERNO,10)
### Summarize the variable
summary(PERNO)
sd(PERNO)
### Create boxplot  
boxplot(PERNO,xlab=c("PERNO"))
### Check for missing observations
sum(PERNO=="")
sum(is.na(PERNO))
```

We follow the same steps for the rest of the person variables:

```{r diag-summary-per-RELAT,echo=FALSE,cache=TRUE,results='asis'}
#### RELAT
var.value.summary('RELAT',tab='per')
```

```{r diag-67, cache=TRUE}
## RELAT
head(RELAT,10)
summary(RELAT[RELAT<99])
sd(RELAT,na.rm=T)
boxplot(RELAT,xlab=c("RELAT"))
sum(RELAT=="")
sum(is.na(RELAT))
```

```{r diag-summary-per-GEND,echo=FALSE,cache=TRUE,results='asis'}
#### GEND
var.value.summary('GEND',tab='per')
```

```{r diag-68, cache=TRUE}
## GEND
head(GEND,10)
summary(GEND[GEND<9])
boxplot(GEND,xlab=c("GEND"))
sum(GEND=="")
sum(is.na(GEND))
# Pie diagram
gendtable<-table(GEND)
lbls <- c("Male","Female","Refused")
pct <- round(gendtable/sum(gendtable)*100)
lbls <- paste(lbls,"\n", pct) # add percents to labels 
lbls<- paste(lbls,"%",sep="") # ad % to labels 
pie(gendtable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of Gender")
```


```{r diag-summary-per-AGE,echo=FALSE,cache=TRUE,results='asis'}
#### AGE: Age
var.value.summary('AGE: Age;(Range',tab='per')
```


```{r diag-69, cache=TRUE}
## AGE
head(AGE,10)
summary(AGE[AGE<998])
sd(AGE,na.rm=T)
boxplot(AGE[AGE<998],xlab=c("Age"),col="gold")
hist(AGE[AGE<998],xlab=c("Age"),col=c("green"))
sum(AGE=="")
sum(is.na(AGE))
##AGEB: Age if refused;(1=Younger than 16 or over 75;2=16 to 75;8=DK;9=RF)
head(AGEB,10)
summary(AGEB[AGEB<8])
sd(AGEB,na.rm=T)
boxplot(AGEB,xlab=c("AGEB"))
```

Based on the final report and on appendices of the CHTS report there should be no
observation where AGE is not equal to 999 or 998. Let us check it:

```{r diag-70, cache=TRUE}
### Check for wrong input 
### (number observations in AGEB = number of observations in AGE=999 and AGE=998)
sum(AGE==999|AGE==998)
sum(!is.na(AGEB)& (AGE==999|AGE==998))
###  NO observations should be found where AGE is not equal to 999 or 998
sum(!is.na(AGEB)&(!AGE==999&!AGE==998))
SAMPN[!is.na(AGEB)&(!AGE==999&!AGE==998)]
PERNO[!is.na(AGEB)&(!AGE==999&!AGE==998)]
```


```{r diag-summary-per-HISP,echo=FALSE,cache=TRUE,results='asis'}
#### HISP
var.value.summary('HISP',tab='per')
```


```{r diag-71, cache=TRUE}
## HISP
head(HISP,10)
summary(HISP[HISP<8])
sd(HISP,na.rm=T)
boxplot(HISP,xlab=c("HISP"))
sum(HISP=="")
sum(is.na(HISP))
```


### Race Variables

There are 5 variables for race. Let us check them:

```{r diag-72, cache=TRUE}
##RACE1: Ethnicity or race; (1 to 97;98=DK;99=RF)
head(RACE1,10)
summary(RACE1[RACE1<97])
sd(RACE1,na.rm=T)
boxplot(RACE1,xlab=c("RACE1"))
sum(RACE1=="")
sum(is.na(RACE1))
SAMPN[is.na(RACE1)]
##RACE2: Ethnicity or race; (1 to 97;98=DK;99=RF)
head(RACE2,10)
summary(RACE2[RACE2<97])
sd(RACE2,na.rm=T)
boxplot(RACE2,xlab=c("RACE2"))
##RACE3: Ethnicity or race; (1 to 97;98=DK;99=RF)
head(RACE3,10)
summary(RACE3[RACE3<97])
sd(RACE3,na.rm=T)
boxplot(RACE3,xlab=c("RACE3"))
##RACE4: Ethnicity or race; (1 to 97;98=DK;99=RF)
head(RACE4,10)
summary(RACE4[RACE4<97])
sd(RACE4,na.rm=T)
boxplot(RACE4,xlab=c("RACE4"))
##O_RACE: Ethnicity or race, other; 
head(O_RACE,10)
###Check missing values
sum(RACE1==97,na.rm=T)
sum(!is.na(O_RACE)&RACE1==97,na.rm=T)
```


```{r diag-summary-per-NTVTY,echo=FALSE,cache=TRUE,results='asis'}
#### NTVTY
var.value.summary('NTVTY',tab='per')
```


```{r diag-73, cache=TRUE}
## NTVTY
head(NTVTY,10)
summary(NTVTY[NTVTY<8])
sd(NTVTY,na.rm=T)
boxplot(NTVTY,xlab=c("NTVTY"))
sum(NTVTY=="")
sum(is.na(NTVTY))
```



```{r diag-summary-per-CNTRY,echo=FALSE,cache=TRUE,results='asis'}
#### CNTRY
var.value.summary('CNTRY',tab='per',desc='Year person moved to United States')
```



```{r diag-74, cache=TRUE}
## CNTRY
head(CNTRY,10)
summary(CNTRY[CNTRY<9998])
sd(CNTRY,na.rm=T)
boxplot(CNTRY,xlab=c("CNTRY"))
###Check missing value
sum(is.na(CNTRY)&NTVTY>1)
```



```{r diag-summary-per-LIC,echo=FALSE,cache=TRUE,results='asis'}
#### LIC
var.value.summary('LIC',tab='per')
```



```{r diag-75, cache=TRUE}
#### LIC
head(LIC,10)
summary(LIC[LIC<8])
sd(LIC,na.rm=T)
boxplot(LIC,xlab=c("LIC"))
###Check missing value
sum(is.na(LIC)&AGE>15&AGE<998)
```


```{r diag-summary-per-USER,echo=FALSE,cache=TRUE,results='asis'}
#### USER
var.value.summary('USER',tab='per')
```


```{r diag-76, cache=TRUE}
## USER
head(USER,10)
summary(USER[USER<98])
sd(USER,na.rm=T)
boxplot(USER[USER<98],xlab=c("Vehicle driven by respondent"),col=c("gold"))
hist(USER[USER<98],xlab=c("Vehicle driven by respondent"),ylim=c(0,10000),col=c("green"))
```


```{r diag-summary-per-TRANS,echo=FALSE,cache=TRUE,results='asis'}
#### TRANS
var.value.summary('TRANS',tab='per')
```


```{r diag-77, cache=TRUE}
## TRANS
head(TRANS,10)
summary(TRANS[TRANS<8])
sd(TRANS,na.rm=T)
boxplot(TRANS,xlab=c("TRANS"))
sum(is.na(TRANS)&AGE>15&AGE<998,na.rm=T)
```


Here we check variables for different types of transit passes:


```{r diag-78, cache=TRUE}
attach(npersondata)
```

```{r diag-79, cache=TRUE}
##TPTYP1: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP1)
summary(TPTYP1[TPTYP1<97])
sd(TPTYP1,na.rm=T)
boxplot(TPTYP1,xlab=c("TPTYP1"))
sum(is.na(TPTYP1)&TRANS==1,na.rm=T)
##TPTYP2: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP2)
summary(TPTYP2[TPTYP2<97])
sd(TPTYP2,na.rm=T)
boxplot(TPTYP2,xlab=c("TPTYP2"))
##TPTYP3: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP3)
summary(TPTYP3)
sd(TPTYP3,na.rm=T)
boxplot(TPTYP3,xlab=c("TPTYP3"))
##TPTYP4: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP4)
summary(TPTYP4)
sd(TPTYP4,na.rm=T)
boxplot(TPTYP4,xlab=c("TPTYP4"))
##TPTYP5: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP5)
summary(TPTYP5)
##TPTYP6: Type of transit pass (1 to 97;98=DK;99=RF)
head(TPTYP6)
summary(TPTYP6)

##O_TPTYP: Type of transit pass, other 
head(O_TPTYP)
sum(is.na(O_TPTYP)&TPTYP1==97)
```

Let us check more transit pass variables:

```{r diag-80, cache=TRUE}
##CLIP1: Type of Clipper Card (1 to 27;98=DK;99=RF)
head(CLIP1)
summary(CLIP1[CLIP1<98])
sd(CLIP1,na.rm=T)
boxplot(CLIP1,xlab=c("CLIP1"))

sum(!is.na(CLIP1)&!TPTYP1==1)
SAMPN[!is.na(CLIP1)&!TPTYP1==1]

##CLIP2: Type of Clipper Card (1 to 27;98=DK;99=RF)
head(CLIP2)
summary(CLIP2[CLIP2<98])
sd(CLIP2,na.rm=T)
boxplot(CLIP2,xlab=c("CLIP2"))

##CLIP3: Type of Clipper Card (1 to 27;98=DK;99=RF)
head(CLIP3)
summary(CLIP3[CLIP3<98])
sd(CLIP3,na.rm=T)
boxplot(CLIP3,xlab=c("CLIP3"))

##COMP: Type of compass card; (1 to 12;98=DK;99=RF)
head(COMP,10)
summary(COMP[COMP<98])
sd(COMP,na.rm=T)
boxplot(COMP,xlab=c("COMP"))

##MET: Type of TAP/EZ card; (1 to 4;98=DK;99=RF)
head(MET,10)
summary(MET[MET<98])
sd(MET,na.rm=T)
boxplot(MET,xlab=c("MET"))
```



```{r diag-summary-per-PASSTL,echo=FALSE,cache=TRUE,results='asis'}
#### PASSTL
var.value.summary('PASSTL',tab='per')
```



```{r diag-81, cache=TRUE}
## PASSTL
head(PASSTL,10)
summary(PASSTL[PASSTL<8])
sd(PASSTL,na.rm=T)
boxplot(PASSTL,xlab=c("PASSTL"))
### Check missing value
sum(is.na(PASSTL)&AGE>15&AGE<998)
SAMPN[is.na(PASSTL)&AGE>15&AGE<998]
PERNO[is.na(PASSTL)&AGE>15&AGE<998]
```



```{r diag-summary-per-FLEX,echo=FALSE,cache=TRUE,results='asis'}
#### FLEX
var.value.summary('FLEX',tab='per')
```



```{r diag-82, cache=TRUE}
## FLEX
head(FLEX,10)
summary(FLEX[FLEX<8])
sd(FLEX,na.rm=T)
boxplot(FLEX,xlab=c("FLEX"))
### Check missing value
sum(is.na(FLEX)&AGE>15&AGE<998)
SAMPN[is.na(FLEX)&AGE>15&AGE<998]
PERNO[is.na(FLEX)&AGE>15&AGE<998]
```


Let us now consider employment status and related variables:

```{r diag-summary-per-EMPLY,echo=FALSE,cache=TRUE,results='asis'}
#### EMPLY
var.value.summary('EMPLY',tab='per')
```


```{r diag-83, cache=TRUE}
## EMPLY
head(EMPLY,10)
summary(EMPLY[EMPLY<8])
sd(EMPLY,na.rm=T)
boxplot(EMPLY,xlab=c("EMPLY"))
sum(is.na(EMPLY)&AGE>15&AGE<998)
SAMPN[is.na(EMPLY)&AGE>15&AGE<998]
PERNO[is.na(EMPLY)&AGE>15&AGE<998]
```


```{r diag-summary-per-WKSTAT,echo=FALSE,cache=TRUE,results='asis'}
#### WKSTAT
var.value.summary('WKSTAT',tab='per')
```


```{r diag-84, cache=TRUE}
## WKSTAT
head(WKSTAT,10)
summary(WKSTAT[WKSTAT<97])
sd(WKSTAT,na.rm=T)
boxplot(WKSTAT,xlab=c("WKSTAT"))
sum(is.na(WKSTAT)&EMPLY>1,na.rm=T)
##O_WKSTAT: Employment status, other
head(O_WKSTAT,10)
sum(is.na(O_WKSTAT)&WKSTAT==97,na.rm=T)
```


```{r diag-summary-per-WLOC,echo=FALSE,cache=TRUE,results='asis'}
#### WLOC
var.value.summary('WLOC',tab='per')
```


```{r diag-85, cache=TRUE}
## WLOC
head(WLOC,10)
summary(WLOC[WLOC<8])
sd(WLOC,na.rm=T)
boxplot(WLOC,xlab=c("WLOC"))
sum(!is.na(WLOC)& EMPLY==1,na.rm=T)
```


```{r diag-summary-per-JOBS,echo=FALSE,cache=TRUE,results='asis'}
#### JOBS
var.value.summary('JOBS',tab='per')
```


```{r diag-86, cache=TRUE}
## JOBS
head(JOBS,10)
summary(JOBS[JOBS<98])
sd(JOBS,na.rm=T)
boxplot(JOBS[JOBS<97],xlab=c("How many jobs"),col=c("green"))
hist(JOBS[JOBS<98],xlab=c("How many jobs"),col=c("yellow"))
hist(JOBS[HOURS>99&JOBS<98],xlab=c("How many jobs"),col=c("yellow"))
```


Let us now check the location variables of the primary work place:


```{r diag-87, cache=TRUE}
attach(npersondata)
```
```{r diag-88, cache=TRUE}
## WNAME: Primary work name
head(WNAME,10)
summary(WNAME)
##WCITY: Primary work city
head(WCITY,10)
sum(is.na(WCITY)&EMPLY==1&WLOC>2)
##WZIP: Primary work zip
summary(WZIP)
sum(is.na(WZIP)&EMPLY==1&WLOC>2)
##WSTAT: Primary work state
head(WSTAT,10)
sum(is.na(WSTAT)&EMPLY==1&WLOC>2)
##WXST1: Primary work cross street1
head(WXST1,10)
summary(WXST1)
##WXST2: Primary work cross street2
head(WXST2,10)
##WXCORD: Primary work X-coordinates
head(WXCORD,10)
summary(WXCORD)
sd(WXCORD,na.rm=T)
boxplot(WXCORD,xlab=c("Primary work X-coordinates"),col=c("yellow"))
hist(WXCORD,freq=FALSE,xlab=c("Primary work X-coordinates"),col=c("maroon"))
##WYCORD: Primary work Y-coordinates
head(WYCORD,10)
summary(WYCORD)
sd(WYCORD,na.rm=T)
boxplot(WYCORD,xlab=c("Primary work Y-coordinates"),col=c("gold"))
hist(WYCORD,freq=FALSE,xlab=c("Primary work Y-coordinates"),col=c("blue"))
```


```{r diag-summary-per-WDAYS,echo=FALSE,cache=TRUE,results='asis'}
#### WDAYS
var.value.summary('WDAYS',tab='per')
```


```{r diag-89, cache=TRUE}
## WDAYS
head(WDAYS,10)
summary(WDAYS[WDAYS<8])
sd(WDAYS[WDAYS<8],na.rm=T)
boxplot(WDAYS,xlab=c("Days at primary work"),col=c("violet"))
hist(WDAYS,xlab=c("Days at primary work"),col=c("gold"))
sum(is.na(WDAYS)&EMPLY==1,na.rm=T)
```


```{r diag-summary-per-WDAY1,echo=FALSE,cache=TRUE,results='asis'}
#### WDAY1
var.value.summary('WDAY1',tab='per')
```


```{r diag-90, cache=TRUE}
## WDAY1
head(WDAY1,10)
summary(WDAY1[WDAY1<98])
sd(WDAY1,na.rm=T)
boxplot(WDAY1,xlab=c("Work days"),col=c("green"))
hist(WDAY1[WDAY1<98],xlab=c("Work days"),col=c("maroon"))
```


Let us now generate a pie chart for WDAY1:


```{r diag-91, cache=TRUE}
###Pie chart
wday1table<-table(WDAY1)
lbls <- paste(names(wday1table))
lbls <- c("a","b","c","d","e","f","g","h","I","J")
pct <- round(wday1table/sum(wday1table)*100)
lbls <- paste(pct,"%", sep="")
lbls <- paste(lbls,"\n", pct) # add percents to labels 
lbls<- paste(lbls, "%", sep="") # ad % to labels 
pie(wday1table,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of Gender",cex=0.8)
legend("topright", c("Mon","Tue","Wed","Thu","Fri","Sat","Sun",
                     "Mon-Fri","Don't Know","Refused"), 
       cex=0.8, fill=rainbow(length(lbls)))
```


Let us check the rest of the WDAY variables:

```{r diag-92, cache=TRUE}
## WDAY2
head(WDAY2,10)
summary(WDAY2[WDAY2<98])
sd(WDAY2,na.rm=T)
boxplot(WDAY2,xlab=c("WDAY2:Work days"),col=c("gold"))
hist(WDAY2,xlab=c("WDAY2:Work days"),col=c("green"))
## WDAY3: Work days (1 to 8; 98=DK;99=RF)
head(WDAY3,10)
summary(WDAY3)
sd(WDAY3,na.rm=T)
boxplot(WDAY3,xlab=c("WDAY3:Work days"),col=c("green"))
hist(WDAY3,xlab=c("WDAY3:Work days"),col=c("blue"))
## WDAY4: Work days (1 to 8; 98=DK;99=RF)
head(WDAY4,10)
summary(WDAY4)
sd(WDAY4,na.rm=T)
boxplot(WDAY4,xlab=c("WDAY4:Work days"),col=c("gold"))
hist(WDAY4,xlab=c("WDAY4:Work days"),col=c("green"))
## WDAY5: Work days (1 to 8; 98=DK;99=RF)
head(WDAY5,10)
summary(WDAY5)
sd(WDAY5,na.rm=T)
boxplot(WDAY5,xlab=c("WDAY5:Work days"),col=c("blue"))
hist(WDAY5,xlab=c("WDAY5:Work days"),col=c("gold"))
## WDAY6: Work days (1 to 8; 98=DK;99=RF)
head(WDAY6,10)
summary(WDAY6)
sd(WDAY6,na.rm=T)
boxplot(WDAY6,xlab=c("WDAY6:Work days"),col=c("gold"))
hist(WDAY6,xlab=c("WDAY6:Work days"),col=c("green"))
## WDAY7: Work days (1 to 8; 98=DK;99=RF)
head(WDAY7,10)
summary(WDAY7)
sd(WDAY7,na.rm=T)
boxplot(WDAY7,xlab=c("WDAY7:Work days"),col=c("gold"))
hist(WDAY7,xlab=c("WDAY7:Work days"),col=c("gold"))
```


```{r diag-summary-per-HOURS,echo=FALSE,cache=TRUE,results='asis'}
#### HOURS
var.value.summary('HOURS',tab='per')
```


```{r diag-93, cache=TRUE}
## HOURS
head(HOURS,10)
summary(HOURS[HOURS<998])
sd(HOURS,na.rm=T)
boxplot(HOURS[HOURS<998],xlab=c("Hours worked per week"),col=c("orange"))
hist(HOURS[HOURS<998],xlab=c("Hours worked per week"),ylim=c(0,25000),col=c("blue"))
## Cross check the data
sum(is.na(HOURS)& EMPLY==1,na.rm=T)
sum(HOURS>99 & HOURS<998,na.rm=T)
sum(HOURS>80 & HOURS<998,na.rm=T)
sum(HOURS>60 & HOURS<998,na.rm=T)
sum(HOURS>99 & HOURS<998,na.rm=T)
```

It is also useful to generate different tables with hours to cross check the employment data:

```{r diag-94, cache=TRUE}
table(HOURS,JOBS)
psf<-npersondata[(HOURS>60&HOURS<998),c('HOURS','JOBS','OCCUP')]
## Cross tabulation Hours (>60) and occupation
table(psf$HOURS,psf$OCCUP)
# Save as csv file
write.csv(table(psf$HOURS,psf$OCCUP),file=pto("occup.csv"))

## Cross tabulation Hours and number of jobs
table(psf$HOURS,psf$JOBS)
write.csv(table(psf$HOURS,psf$JOBS),file=pto("job.csv"))
```


```{r diag-summary-per-WSCHED,echo=FALSE,cache=TRUE,results='asis'}
#### WSCHED
var.value.summary('WSCHED',tab='per')
```


```{r diag-95, cache=TRUE}
## WSCHED
head(WSCHED,10)
summary(WSCHED[WSCHED<8])
sd(WSCHED,na.rm=T)
boxplot(WSCHED,xlab=c("WSCHED"))
hist(WSCHED,xlab=c("Hours work per week"),ylim=c(0,25000),col=c("blue"))
sum(is.na(WSCHED)& EMPLY==1,na.rm=T)
```


```{r diag-summary-per-COMPR,echo=FALSE,cache=TRUE,results='asis'}
#### COMPR
var.value.summary('COMPR',tab='per')
```


```{r diag-96, cache=TRUE}
## COMPR
head(COMPR,10)
summary(COMPR[COMPR<8])
sd(COMPR,na.rm=T)
boxplot(COMPR,xlab=c("COMPR"))
sum(is.na(COMPR)& EMPLY==1&WSCHED<4,na.rm=T)
```


```{r diag-summary-per-WMODE,echo=FALSE,cache=TRUE,results='asis'}
#### WMODE
var.value.summary('WMODE',tab='per')
```


```{r diag-97, cache=TRUE}
## WMODE
head(WMODE,10)
summary(WMODE[WMODE<99])
sd(WMODE,na.rm=T)
boxplot(WMODE[WMODE<99],xlab=c("Work mode"),col=c("orange"))
hist(WMODE[WMODE<99],xlab=c("Work mode"),col=c("blue"))
sum(is.na(WMODE)& EMPLY==1&WLOC>2,na.rm=T)
```


```{r diag-summary-per-INDUS,echo=FALSE,cache=TRUE,results='asis'}
#### INDUS
var.value.summary('INDUS',tab='per')
```


```{r diag-98, cache=TRUE}
## INDUS
head(INDUS,10)
summary(INDUS[INDUS<97])
sd(INDUS,na.rm=T)
boxplot(INDUS,xlab=c("Industry"),col=c("orange"))
hist(INDUS,xlab=c("Industry"),col=c("maroon"))
boxplot(INDUS,xlab=c("INDUS"))
hist(INDUS[HOURS>99],xlab=c("Industry"),col=c("orange"))

## O_INDUS: Industry,other (11 to 92;97=other;98=DK;99=RF)
head(O_INDUS,10)
sum(is.na(O_INDUS)& INDUS==97)
```


```{r diag-summary-per-OCCUP,echo=FALSE,cache=TRUE,results='asis'}
#### OCCUP
var.value.summary('OCCUP',tab='per')
```


```{r diag-99, cache=TRUE}
attach(npersondata)
```
```{r diag-100, cache=TRUE}
##OCCUP
head(OCCUP,10)
summary(OCCUP[OCCUP<97])
sd(OCCUP,na.rm=T)
boxplot(OCCUP,xlab=c("Occupation"),col=c("magenta"))
hist(OCCUP,xlab=c("Occupation"),col=c("orange"))

```

Now let us check the location variables for the second job characteristics:

```{r diag-101, cache=TRUE}
## WLOC2: Work location 2 (1=Fixed; 2=Home;3=No fixed;8=DK;9=RF)
head(WLOC2,10)
summary(WLOC2[WLOC2<8])
sd(WLOC2,na.rm=T)
boxplot(WLOC2,xlab=c("WLOC2"))
sum(is.na(WLOC2)& JOBS>1&JOBS<6,na.rm=T)
## WNAME2: Secondary work name
head(WNAME2,10)
summary(WNAME2)
## WCITY2: Secondary work city
head(WCITY2,10)
sum(is.na(WCITY2)&WLOC2>2)
## WZIP2: Secondary work ZIP
head(WZIP2,10)
sum(is.na(WZIP2)&WLOC2>2)
##WXST2_1: Secondary work cross street1
head(WXST2_1,10)
##WXST2_2: Secondary work cross street2
head(WXST2_2,10)
##WSTAT2: Secondary work state
head(WSTAT2,10)
sum(is.na(WSTAT2)&WLOC>2)
```


```{r diag-summary-per-WDAYS2,echo=FALSE,cache=TRUE,results='asis'}
#### WDAYS2
var.value.summary('WDAYS2',tab='per')
```


```{r diag-102, cache=TRUE}
## WDAYS2
head(WDAYS2,10)
summary(WDAYS2[WDAYS2<8])
sd(WDAYS2[WDAYS2<8],na.rm=T)
boxplot(WDAYS2,xlab=c("WDAYS2"))
boxplot(WDAYS2,xlab=c("Days at secondary work"),col=c("orange"))
hist(WDAYS2,xlab=c("Days at secondary work"),col=c("blue"))
sum(is.na(WDAYS2)&EMPLY==1& JOBS>1&JOBS<6,na.rm=T)
```


```{r diag-summary-per-DISAB,echo=FALSE,cache=TRUE,results='asis'}
#### DISAB
var.value.summary('DISAB',tab='per')
```


```{r diag-103, cache=TRUE}
attach(npersondata)
```

```{r diag-104, cache=TRUE}
## DISAB
head(DISAB,10)
summary(DISAB[DISAB<8])
sd(DISAB,na.rm=T)
boxplot(DISAB,xlab=c("DISAB"))
## DTYPE1: Disability type 1 (1 to 6; 98=DK;99=RF)
head(DTYPE1,10)
summary(DTYPE1[DTYPE1<97])
sd(DTYPE1,na.rm=T)
boxplot(DTYPE1,xlab=c("DTYPE1"))
sum(is.na(DTYPE1)&DISAB==1,na.rm=T)
SAMPN[is.na(DTYPE1)&DISAB==1]
PERNO[is.na(DTYPE1)&DISAB==1]
## DTYPE2: Disability type 2 (1 to 6; 98=DK;99=RF)
head(DTYPE2,10)
summary(DTYPE2[DTYPE2<97])
sd(DTYPE2,na.rm=T)
boxplot(DTYPE2,xlab=c("DTYPE2"))
## DTYPE3: Disability type 3 (1 to 6; 98=DK;99=RF)
head(DTYPE3,10)
summary(DTYPE3[DTYPE3<97])
sd(DTYPE3,na.rm=T)
boxplot(DTYPE3,xlab=c("DTYPE3"))
## DTYPE4: Disability type 4 (1 to 6; 98=DK;99=RF)
head(DTYPE4,10)
summary(DTYPE4[DTYPE4<97])
sd(DTYPE4,na.rm=T)
boxplot(DTYPE4,xlab=c("DTYPE4"))
## DTYPE5: Disability type 5 (1 to 6; 98=DK;99=RF)
head(DTYPE5,10)
summary(DTYPE5[DTYPE5<97])
sd(DTYPE5,na.rm=T)
boxplot(DTYPE5,xlab=c("DTYPE5"))
## DTYPE6: Disability type 6 (1 to 6; 98=DK;99=RF)
head(DTYPE6,10)
summary(DTYPE6[DTYPE6<97])
sd(DTYPE6,na.rm=T)
boxplot(DTYPE6,xlab=c("DTYPE6"))
## DTYPE7: Disability type 7 (1 to 6; 98=DK;99=RF)
head(DTYPE7,10)
summary(DTYPE7)
## O_DTYPE: Other, Disability type  
head(O_DTYPE,10)
sum(is.na(O_DTYPE)&DTYPE1==97)
```


```{r diag-summary-per-DSLIC,echo=FALSE,cache=TRUE,results='asis'}
#### DSLIC
var.value.summary('DSLIC',tab='per')
```


```{r diag-105, cache=TRUE}
## DSLIC:Disabled license plate (1=yes;2=no;8=DK;9=RF)
head(DSLIC,10)
summary(DSLIC[DSLIC<8])
sd(DSLIC,na.rm=T)
boxplot(DSLIC,xlab=c("DSLIC"))
sum(is.na(DSLIC)&DISAB==1&(AGE>15&AGE<998))
```


```{r diag-summary-per-EDIS,echo=FALSE,cache=TRUE,results='asis'}
#### EDIS
var.value.summary('EDIS',tab='per')
```


```{r diag-106, cache=TRUE}
## EDIS
head(EDIS,10)
summary(EDIS[EDIS<8])
sd(EDIS,na.rm=T)
boxplot(EDIS,xlab=c("DSLIC"))
sum(is.na(EDIS)&DISAB==1)
```


```{r diag-summary-per-TTRIP,echo=FALSE,cache=TRUE,results='asis'}
#### TTRIP
var.value.summary('TTRIP',tab='per')
```


```{r diag-107, cache=TRUE}
##TTRIP
head(TTRIP,10)
summary(TTRIP[TTRIP<98])
sd(TTRIP,na.rm=T)
boxplot(TTRIP[TTRIP<98],xlab=c("Transit trips in past week"),col=c("orange"))
hist(TTRIP[TTRIP<98],breaks=20,xlab=c("Transit trips in past week"),col=c("green"))
boxplot(TTRIP,xlab=c("TTRIP"))
sum(is.na(TTRIP))
```


```{r diag-summary-per-TRNSUB,echo=FALSE,cache=TRUE,results='asis'}
#### TRNSUB
var.value.summary('TRNSUB',tab='per')
```


```{r diag-108, cache=TRUE}
## TRNSUB
head(TRNSUB,10)
summary(TRNSUB[TRNSUB<8])
sd(TRNSUB,na.rm=T)
boxplot(TRNSUB,xlab=c("TRNSUB"))
sum(is.na(TRNSUB)&TTRIP>0)
```


```{r diag-summary-per-SUBAMT,echo=FALSE,cache=TRUE,results='asis'}
#### SUBAMT
var.value.summary('SUBAMT',tab='per',val.list=FALSE)
```


```{r diag-109, cache=TRUE}
##SUBAMT
SUBAMT <- as.integer(SUBAMT)
head(SUBAMT,10)
summary(SUBAMT[SUBAMT<999998])
sd(SUBAMT[SUBAMT<999998],na.rm=T)
boxplot(SUBAMT[SUBAMT<999998],xlab=c("Subsidized amount"),col=c("orange"))
hist(SUBAMT,xlab=c("Subsidized amount"),col=c("maroon"))
sum(is.na(SUBAMT)&TRNSUB==1,na.rm=T)
```


```{r diag-summary-per-SUBUNT,echo=FALSE,cache=TRUE,results='asis'}
#### SUBUNT
var.value.summary('SUBUNT',tab='per')
```


```{r diag-110, cache=TRUE}
## SUBUNT
head(SUBUNT,10)
summary(SUBUNT[SUBUNT<8])
sd(SUBUNT,na.rm=T)
boxplot(SUBUNT,xlab=c("Fare unit"),col=c("orange"))
hist(SUBUNT,xlab=c("Fare unit"),col=c("maroon"))
```

At this point, let us generate a pie chart for fare unit (SUBUNT).

```{r diag-111, cache=TRUE}
###Pie chart
faretable<-table(SUBUNT)
pct <- round(faretable/sum(faretable)*100)
lbls <- paste(pct,"%", sep="")
pie(faretable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of fare unit",cex=0.8)
legend("topright", c("Per Hour","Per day","Per week","Per month","Per Semester",
                     "Per Year","Other","Don't Know","Refused"), 
       cex=0.8, fill=rainbow(length(lbls)))
```


```{r diag-summary-per-O_SUBUNT,echo=FALSE,cache=TRUE,results='asis'}
#### O_SUBUNT
var.value.summary('O_SUBUNT',tab='per',val.list=FALSE)
```


```{r diag-112, cache=TRUE}
## O_SUBUNT
head(O_SUBUNT,10)
sum(is.na(O_SUBUNT)&SUBUNT==7)
```


```{r diag-summary-per-WTRIP,echo=FALSE,cache=TRUE,results='asis'}
#### WTRIP
var.value.summary('WTRIP',tab='per')
```


```{r diag-113, cache=TRUE}
## WTRIP
head(WTRIP,10)
summary(WTRIP[WTRIP<98])
sd(WTRIP[WTRIP<98],na.rm=T)
boxplot(WTRIP,xlab=c("Walk in the last week"),col=c("green"))
hist(WTRIP[WTRIP<98],xlab=c("Walk in the last week"),col=c("gold"))
sum(is.na(WTRIP))
```


```{r diag-summary-per-BTRIP,echo=FALSE,cache=TRUE,results='asis'}
#### BTRIP
var.value.summary('BTRIP',tab='per')
```


```{r diag-114, cache=TRUE}
## BTRIP
head(BTRIP,10)
summary(BTRIP[BTRIP<98])
sd(BTRIP,na.rm=T)
boxplot(BTRIP,xlab=c("Bicycle trips in the last week "),col=c("green"))
hist(BTRIP[BTRIP<98],xlab=c("Bicycle trips in the last week "),col=c("green"))
```


Let us now analyze education variables

```{r diag-summary-per-STUDE,echo=FALSE,cache=TRUE,results='asis'}
#### STUDE
var.value.summary('STUDE',tab='per')
```



```{r diag-115, cache=TRUE}
## STUDE
head(STUDE,10)
summary(STUDE[STUDE<8])
sd(STUDE,na.rm=T)
boxplot(STUDE,xlab=c("STUDE"))
sum(is.na(STUDE))
```



```{r diag-summary-per-SCHOL,echo=FALSE,cache=TRUE,results='asis'}
#### SCHOL
var.value.summary('SCHOL',tab='per')
```



```{r diag-116, cache=TRUE}
## SCHOL
head(SCHOL,10)
summary(SCHOL[SCHOL<97])
sd(SCHOL,na.rm=T)
boxplot(SCHOL,xlab=c("School grade level"),col=c("green"))
hist(SCHOL[SCHOL<97],xlab=c("School grade level"),col=c("gold"))
sum(is.na(SCHOL)&STUDE<3)
```


It is useful to display a pie chart for the SCHOL variable:

```{r diag-117, cache=TRUE}
###Pie chart
sgtable<-table(SCHOL)
pct <- round(sgtable/sum(sgtable)*100)
lbls <- paste(pct,"%", sep="")
pie(sgtable,labels = lbls, col=rainbow(length(lbls)),
    main="Pie Chart of School Attendence",cex=0.8)
legend("topright",c("Daycare","Pre-school","Kindergarten-Grade 8","Grade 9-12",
                    "Technical","Community college","University","Graduate School",
                    "Other","Don't Know","Refused"), 
       cex=0.8, fill=rainbow(length(lbls)))
```



```{r diag-summary-per-O_SCHOL,echo=FALSE,cache=TRUE,results='asis'}
#### O_SCHOL
var.value.summary('O_SCHOL',tab='per',val.list=FALSE)
```



```{r diag-118, cache=TRUE}
## O_SCHOL
head(O_SCHOL,10)
sum(is.na(O_SCHOL)&SCHOL==97)
```



```{r diag-summary-per-SLOC,echo=FALSE,cache=TRUE,results='asis'}
#### SLOC
var.value.summary('SLOC',tab='per')
```



```{r diag-119, cache=TRUE}
## SLOC
head(SLOC,10)
summary(SLOC[SLOC<8])
sd(SLOC,na.rm=T)
boxplot(SLOC,xlab=c("SLOC"))
sum(is.na(SLOC)&SCHOL>1&SCHOL<5,na.rm=T)
```



```{r diag-summary-per-SONLN,echo=FALSE,cache=TRUE,results='asis'}
#### SONLN
var.value.summary('SONLN',tab='per')
```



```{r diag-120, cache=TRUE}
## SONLN
head(SONLN,10)
summary(SONLN[SONLN<8])
sd(SONLN,na.rm=T)
boxplot(SONLN,xlab=c("SONLN"))
sum(is.na(SONLN)&SCHOL>4&SCHOL<9,na.rm=T)
```



```{r diag-summary-per-PRESCH,echo=FALSE,cache=TRUE,results='asis'}
#### PRESCH
var.value.summary('PRESCH',tab='per')
```



```{r diag-121, cache=TRUE}
##PRESCH
head(PRESCH,10)
summary(PRESCH[PRESCH<8])
sd(PRESCH,na.rm=T)
boxplot(PRESCH,xlab=c("PRESCH"))
sum(is.na(PRESCH)&SCHOL==1,na.rm=T)
##O_PRESCH: Pre-school location,other 
head(O_PRESCH,10)
sum(is.na(O_PRESCH)& PRESCH==7)
```


Now let us examine school location variables:


```{r diag-122, cache=TRUE}
##SNAME: School name
head(SNAME,10)
##SCITY: School city
head(SCITY,10)
##SZIP: School zip
head(SZIP,10)
##SXST1: School cross streets
head(SXST1,10)
##SXST2: School cross street
head(SXST2,10)
## SSTAT: School State
head(SSTAT,10)

##SXCORD: School x-coordinates
head(SXCORD,10)
summary(SXCORD)
sd(SXCORD,na.rm=T)
boxplot(SXCORD,xlab=c("School x-coordinates"),col=c("yellow"))
hist(SXCORD,freq=FALSE,xlab=c("School"),col=c("maroon"))

##SYCORD: School y-coordinates
head(SYCORD,10)
summary(SYCORD)
sd(SYCORD,na.rm=T)
```



```{r diag-summary-per-SMODE,echo=FALSE,cache=TRUE,results='asis'}
#### SMODE
var.value.summary('SMODE',tab='per')
```



```{r diag-123, cache=TRUE}
## SMODE
head(SMODE,10)
summary(SMODE[SMODE<99])
sd(SMODE,na.rm=T)
boxplot(SMODE[SMODE<99],xlab=c("School mode"),col=c("yellow"))
hist(SMODE[SMODE<99],xlab=c("School mode"),col=c("green"))
```



```{r diag-summary-per-EDUCA,echo=FALSE,cache=TRUE,results='asis'}
#### EDUCA
var.value.summary('EDUCA',tab='per')
```



```{r diag-124, cache=TRUE}
##EDUCA
head(EDUCA,10)
summary(EDUCA[EDUCA<8])
sd(EDUCA,na.rm=T)
boxplot(EDUCA,xlab=c("EDUCA"))
sum(is.na(EDUCA))
##O_EDUCA: Level of education completed,other;
head(O_EDUCA,10)
sum(is.na(EDUCA)&EDUCA==7)
```



```{r diag-summary-per-INTRV,echo=FALSE,cache=TRUE,results='asis'}
#### INTRV
var.value.summary('INTRV',tab='per')
```



```{r diag-125, cache=TRUE}
##INTRV
head(INTRV,10)
summary(INTRV)
sd(INTRV,na.rm=T)
```



```{r diag-summary-per-PROXY,echo=FALSE,cache=TRUE,results='asis'}
#### PROXY
var.value.summary('PROXY',tab='per',val.list=FALSE)
```



```{r diag-126, cache=TRUE}
## PROXY
head(PROXY,10)
summary(PROXY)
sd(PROXY,na.rm=T)
```



```{r diag-summary-per-CMPLG,echo=FALSE,cache=TRUE,results='asis'}
#### CMPLG
var.value.summary('CMPLG',tab='per')
```



```{r diag-127, cache=TRUE}
##CMPLG
head(CMPLG,10)
summary(CMPLG[CMPLG<8])
sd(CMPLG,na.rm=T)
boxplot(CMPLG,xlab=c("CMPLG"))
```



```{r diag-summary-per-HVLOG,echo=FALSE,cache=TRUE,results='asis'}
#### HVLOG
var.value.summary('HVLOG',tab='per')
```



```{r diag-128, cache=TRUE}
##HVLOG
head(HVLOG,10)
summary(HVLOG[HVLOG<9])
sd(HVLOG,na.rm=T)
boxplot(HVLOG,xlab=c("HVLOG"))
```


Let us now consider person trips:


```{r diag-summary-per-PTRIPS,echo=FALSE,cache=TRUE,results='asis'}
#### PTRIPS
var.value.summary('PTRIPS',tab='per',val.list=FALSE)
```



```{r diag-129, cache=TRUE}
## PTRIPS
head(PTRIPS,10)
summary(PTRIPS)
sd(PTRIPS,na.rm=T)
boxplot(PTRIPS,xlab=c("Person trips"),col=c("gold"))
hist(PTRIPS,xlab=c("Person trips"),col=c("green"))
```



```{r diag-summary-per-TOLLF,echo=FALSE,cache=TRUE,results='asis'}
#### TOLLF
var.value.summary('TOLLF',tab='per')
```



```{r diag-130, cache=TRUE}
## TOLLF
head(TOLLF,10)
summary(TOLLF[TOLLF<8])
sd(TOLLF,na.rm=T)
boxplot(TOLLF,xlab=c("TOLLF"))
```


There are 10 variables related to toll roads. Let us check them:


```{r diag-131, cache=TRUE}
##TOLLR1: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR1,10)
summary(TOLLR1[TOLLR1<98])
sd(TOLLR1,na.rm=T)
boxplot(TOLLR1,xlab=c("Toll Road"),col=c("green"))
hist(TOLLR1,xlab=c("Person trips"),col=c("green"))
sum(is.na(TOLLR1)& TOLLF==1,na.rm=T)

##TOLLR2: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR2,10)
summary(TOLLR2[TOLLR2<98])
sd(TOLLR2,na.rm=T)
boxplot(TOLLR2,xlab=c("Toll Road"),col=c("yellow"))

##TOLLR3: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR3,10)
summary(TOLLR3[TOLLR3<98])
sd(TOLLR3,na.rm=T)
boxplot(TOLLR3,xlab=c("Toll Road"),col=c("yellow"))

##TOLLR4: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR4,10)
summary(TOLLR4)

##TOLLR5: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR5,10)
summary(TOLLR5)

##TOLLR6: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR6,10)
summary(TOLLR6)

##TOLLR7: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR7,10)
summary(TOLLR7)

##TOLLR8: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR8,10)
summary(TOLLR8)

##TOLLR9: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR9,10)
summary(TOLLR9)

##TOLLR10: Toll Road (1 to 9, 98=DK, 99=RF)
head(TOLLR10,10)
summary(TOLLR10)
```

Let us now check the 10 toll bridge related variables:

```{r diag-132, cache=TRUE}
###TOLLB1: Toll Bridge (1 to 7, 98=DK, 99=RF)
head(TOLLB1,10)
summary(TOLLB1[TOLLB1<98])
sd(TOLLB1,na.rm=T)
boxplot(TOLLB1,xlab=c("Toll Bridge"),col=c("green"))
sum(is.na(TOLLB1)& TOLLF==2,na.rm=T)

##TOLLB2: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB2,10)
summary(TOLLB2[TOLLB2<98])
sd(TOLLB2,na.rm=T)
boxplot(TOLLB2,xlab=c("TOLLB2"))

##TOLLB3: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB3,10)
summary(TOLLB3)
sd(TOLLB3,na.rm=T)
boxplot(TOLLB3,xlab=c("TOLLB3"))

##TOLLB4: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB4,10)
summary(TOLLB4)

##TOLLB5: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB5,10)
summary(TOLLB5)

##TOLLB6: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB6,10)
summary(TOLLB6)

##TOLLB7: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB7,10)
summary(TOLLB7)

##TOLLB8: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB8,10)
summary(TOLLB8)

##TOLLB9: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB9,10)
summary(TOLLB9)

##TOLLB10: Toll bridge(1 to 7, 98=DK, 99=RF)
head(TOLLB10,10)
summary(TOLLB10)
```



```{r diag-summary-per-HOVL,echo=FALSE,cache=TRUE,results='asis'}
#### HOVL
var.value.summary('HOVL',tab='per')
```



```{r diag-133, cache=TRUE}
## HOVL
head(HOVL,10)
summary(HOVL[HOVL<98])
sd(HOVL,na.rm=T)
boxplot(HOVL,xlab=c("HOVL"))
```



```{r diag-summary-per-NOGOWHY,echo=FALSE,cache=TRUE,results='asis'}
#### NOGOWHY
var.value.summary('NOGOWHY',tab='per',val.list=FALSE)
```



```{r diag-134, cache=TRUE}
## NOGOWHY
head (NOGOWHY,10)
summary(NOGOWHY[NOGOWHY<97])
sd(NOGOWHY,na.rm=T)
boxplot(NOGOWHY,xlab=c("NOGOWHY"))
sum(is.na(NOGOWHY)&PTRIPS==0,na.rm=T)

## NOGOWHY_O: Why no trips on travel day, other; 
head (NOGOWHY_O,10)
sum(is.na(NOGOWHY_O)&NOGOWHY==97)
```



```{r diag-summary-per-InComplete,echo=FALSE,cache=TRUE,results='asis'}
#### InComplete
var.value.summary('InComplete',tab='per')
```



```{r diag-135, cache=TRUE}
##InComplete
head(InComplete,10)
summary(InComplete)
```

```{r diag-summary-per-Moto_trip,echo=FALSE,cache=TRUE,results='asis'}
#### Moto_trip
var.value.summary('Moto_trip',tab='per')
```

```{r diag-136, cache=TRUE}
## Moto_trip
head(Moto_trip,10)
summary(Moto_trip)
sd(Moto_trip,na.rm=T)
boxplot(Moto_trip,xlab=c("Moto_trip"))
```


We also need to analyze work location variables:

```{r diag-summary-per-WCTFIP,echo=FALSE,cache=TRUE,results='asis'}
#### WCTFIP
var.value.summary('WCTFIP',tab='per',val.list=FALSE)
```

```{r diag-137, cache=TRUE}
## WCTFIP
head(WCTFIP,10)
summary(WCTFIP[WCTFIP<999])
sd(WCTFIP,na.rm=T)
```




### WTRACT: Work location census tract

```{r diag-138, cache=TRUE}
## WTRACT
head(WTRACT,10)
summary(WTRACT)
sd(WTRACT,na.rm=T)
```


Now let us check variables related to school location:

```{r diag-139, cache=TRUE}
## CTFIP: School location county FIP  Code 2010
head(SCTFIP,10)
summary(SCTFIP[SCTFIP<999])
sd(SCTFIP,na.rm=T)

## STRACT: School location census tract ID 2010
head(STRACT,10)
summary(STRACT)
sd(STRACT,na.rm=T)

## SPrimaryCity: School location primary city
head(SPrimaryCity,10)

## SSTFIP: School location state fips
head(SSTFIP,10)
summary(SSTFIP[SSTFIP<99])
sd(SSTFIP,na.rm=T)
```

And here, we check more variables related to work location:

```{r diag-140, cache=TRUE}
##WPrimaryCity: Work location primary city
head(WPrimaryCity,10)

##WSTFIP: Work location state fips code
head(WSTFIP,10)
summary(WSTFIP[WSTFIP<99])
sd(WSTFIP,na.rm=T)

##W2PrimaryCity: Secondary Work location primary city
head(W2PrimaryCity,10)

##W2STFIP: Secondary Work location state fips code
head(W2STFIP,10)
summary(W2STFIP)
sd(W2STFIP,na.rm=T)
```


Now, consider person weights:

```{r diag-summary-per-PERWGT,echo=FALSE,cache=TRUE,results='asis'}
#### PERWGT
var.value.summary('PERWGT',tab='per',val.list=FALSE)
```



```{r diag-141, cache=TRUE}
## PERWGT
head(PERWGT,10)
summary(PERWGT)
sd(PERWGT,na.rm=T)
boxplot(PERWGT,xlab=c("PERWGT"))
```



```{r diag-summary-per-EXPPERWGT,echo=FALSE,cache=TRUE,results='asis'}
#### EXPPERWGT
var.value.summary('EXPPERWGT',tab='per',val.list=FALSE)
```



```{r diag-142, cache=TRUE}
## EXPPERWGT
head(EXPPERWGT,10)
summary(EXPPERWGT)
sd(EXPPERWGT,na.rm=T)
boxplot(EXPPERWGT,xlab=c("EXPPERWGT"))
```

We have checked all the variables of the person dataset, so we can detach the person data frame:

```{r diag-143, cache=TRUE}
detach(npersondata)
```




## Vehicle Data

We are now ready to check the vehicle data variables. First we load the vehicle data frame, check its dimension, and list the variable names. 


```{r diag-144, cache=TRUE}
veh_data <- chts_veh

# Dimension of the data frame
dim(veh_data)

# Show variable names
names(veh_data)
```

Now, let us attach the vehicle dataset to check its variables one by one. 

```{r diag-145, cache=TRUE}
# Attach the data frame
attach(veh_data)
```


First, let us sort the data by sample number.


```{r diag-146, cache=TRUE}
# SAMPN: Sample number
# Sorting data by sample number
veh_data<-veh_data[order(SAMPN),]
```


Now that it is done, let us check variables. 


```{r diag-summary-per-VEHNO,echo=FALSE,cache=TRUE,results='asis'}
#### VEHNO
var.value.summary('VEHNO',tab='veh',val.list=FALSE)
```



```{r diag-147, cache=TRUE}
## VEHNO
### Show the first 10 observations (if you want to see more put that number in place of 10)
head(VEHNO,10)
###Summarize of the variable
summary(VEHNO)
sd(VEHNO,na.rm=T)
### Check missing observations
sum(VEHNO=="")
sum(is.na(VEHNO))
### Create boxplot  
boxplot(VEHNO,xlab=c("VEHNO"))
```



```{r diag-summary-per-YEAR,echo=FALSE,cache=TRUE,results='asis'}
#### YEAR
var.value.summary('YEAR',tab='veh')
```



```{r diag-148, cache=TRUE}
## YEAR
head(YEAR,10)
summary(YEAR[YEAR<9998])
sd(YEAR,na.rm=T)
```


Let us generate a boxplot and a histogram for YEAR after excluding observations with error codes (9998)

```{r diag-149, cache=TRUE}
boxplot(YEAR[YEAR<9998],xlab=c("Year of vehicle"),col=c("gold"))
hist(YEAR[YEAR<9998],xlab=c("Year of vehicle"),col=c("green"))
```


Let us count the missing observations and check the number of observations for year less than 1960


```{r diag-150, cache=TRUE}
sum(YEAR=="")
sum(is.na(YEAR))
sum(YEAR<=1960,na.rm=T)
```


It is also useful to generate cross tabulations for the YEAR and MAKE variables:


```{r diag-151, cache=TRUE}
## Cross tabulation YEAR<=1960 and Make
veht<-veh_data[(YEAR<=1960),c('YEAR','MAKE','BODY')]
table(veht$YEAR,veht$MAKE)
```


Now generate a cross tabulation for YEAR and BODY:


```{r diag-152, cache=TRUE}
## Cross tabulation YEAR<=1960 and BODY
table(veht$YEAR,veht$BODY)
```


Let us check vehicle characteristics:

```{r diag-summary-per-MAKE,echo=FALSE,cache=TRUE,results='asis'}
#### MAKE
var.value.summary('MAKE',tab='veh')
```



```{r diag-153, cache=TRUE}
## MAKE
head(MAKE,10)
summary(MAKE[MAKE<97])
boxplot(MAKE,xlab=c("Vehicle make"),col=c("green"))
hist(MAKE,xlab=c("Vehicle make"),col=c("orange"))
sum(MAKE=="")
sum(is.na(MAKE))

## O_MAKE: Other,Vehicle make 
head(O_MAKE,10)
sum(is.na(O_MAKE)&MAKE==97)
```


```{r diag-summary-per-MODEL,echo=FALSE,cache=TRUE,results='asis'}
#### MODEL
var.value.summary('MODEL',tab='veh',val.list=FALSE)
```



```{r diag-154, cache=TRUE}
## MODEL
head(MODEL,10)
sum(is.na(MODEL))
SAMPN[is.na(MODEL)]
VEHNO[is.na(MODEL)]
```


```{r diag-summary-per-SERIES,echo=FALSE,cache=TRUE,results='asis'}
#### SERIES
var.value.summary('SERIES',tab='veh')
```



```{r diag-155, cache=TRUE}
## SERIES
SERIES <- as.integer(SERIES)
head(SERIES,10)
summary(SERIES[SERIES<999997])
boxplot(SERIES,xlab=c("SERIES"))
hist(SERIES)
sum(is.na(SERIES))
SAMPN[is.na(SERIES)]
VEHNO[is.na(SERIES)]

## O_SERIES: Other, Series 
head(O_SERIES,10)
sum(is.na(SERIES)&SERIES==999997,na.rm=T)
```



```{r diag-summary-per-BODY,echo=FALSE,cache=TRUE,results='asis'}
#### BODY
var.value.summary('BODY',tab='veh')
```



```{r diag-156, cache=TRUE}
## BODY
head(BODY,10)
summary(BODY[BODY<97])
boxplot(BODY[BODY<97],xlab=c("Body type"),col=c("yellow"))
hist(BODY[BODY<97],xlab=c("Body type"),col=c("green"))
hist
sum(is.na(BODY))
```


Let us create a pie chart for the BODY variable:


```{r diag-157, cache=TRUE}
### Pie chart
bdtable<-table(BODY)
pct <- round(bdtable/sum(bdtable)*100)
lbls <- paste(pct,"%", sep="")
pie(bdtable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of body type",cex=0.8)
legend("topright",c("1","2","3","4","5","6","7","8","9","10",
                    "11","12","13","97","98","99"), 
       cex=0.8, fill=rainbow(length(lbls)))
```



```{r diag-summary-per-O_BODY,echo=FALSE,cache=TRUE,results='asis'}
#### O_BODY
var.value.summary('O_BODY',tab='veh',val.list=FALSE)
```



```{r diag-158, cache=TRUE}
## O_BODY
head(O_BODY,10)
sum(is.na(BODY)&BODY==97)
```



```{r diag-summary-per-FUELT1,echo=FALSE,cache=TRUE,results='asis'}
#### FUELT1
var.value.summary('FUELT1',tab='veh')
```



```{r diag-159, cache=TRUE}
## FUELT1
head(FUELT1,10)
summary(FUELT1[FUELT1<8])
boxplot(FUELT1,xlab=c("FUELT1"))
hist(FUELT1,xlab=c("FUEL type"),col=c("maroon"))
sum(is.na(FUELT1))
```


Now let us generate a pie chart for the FUELT1 variable:


```{r diag-160, cache=TRUE}
###Pie chart
ftyptable<-table(FUELT1)
pct <- round(ftyptable/sum(ftyptable)*100)
lbls <- paste(pct,"%", sep="")
pie(ftyptable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of fuel type",cex=0.8)
legend("topright",c("1","2","3","4","5","6","7","8","9"), cex=0.8, fill=rainbow(length(lbls)))
```


It is time to summarize the other FUEL variables:


```{r diag-161, cache=TRUE}
## FUELT2: FUEL type  (1 to 7,8=DK;9=RF)
head(FUELT2,10)
summary(FUELT2[FUELT2<8])
boxplot(FUELT2,xlab=c("FUELT2"))
hist(FUELT2,xlab=c("FUEL type "),col=c("green"))

## FUELT3: FUEL type  (1 to 7,8=DK;9=RF)
head(FUELT3,10)
summary(FUELT3[FUELT3<8])
boxplot(FUELT3,xlab=c("FUELT3"))

## FUELT4: FUEL type  (1 to 7,8=DK;9=RF)
head(FUELT4,10)
summary(FUELT4)

## FUELT5: FUEL type  (1 to 7,8=DK;9=RF)
head(FUELT5,10)
summary(FUELT5)

## FUELT6: FUEL type  (1 to 7,8=DK;9=RF)
head(FUELT6,10)
summary(FUELT6)

## O_FUELT: Other, FUEL type  
head(O_FUELT,10)
sum(is.na(O_FUELT)&FUELT1==7)
```



```{r diag-summary-per-CIGLT,echo=FALSE,cache=TRUE,results='asis'}
#### CIGLT
var.value.summary('CIGLT',tab='veh')
```



```{r diag-162, cache=TRUE}
## CIGLT
head(CIGLT,10)
summary(CIGLT[CIGLT<8])
boxplot(CIGLT,xlab=c("CIGLT"))
hist(CIGLT)
```


Now, consider vehicle ownership variables:


```{r diag-summary-per-VEHAQ,echo=FALSE,cache=TRUE,results='asis'}
#### VEHAQ
var.value.summary('VEHAQ',tab='veh')
```



```{r diag-163, cache=TRUE}
## VEHAQ
head(VEHAQ,10)
summary(VEHAQ[VEHAQ<8])
boxplot(VEHAQ,xlab=c("VEHAQ"))
boxplot(VEHAQ,xlab=c("Vehicle acquired"),col=c("gold"))
```


```{r diag-summary-per-VEHOWN,echo=FALSE,cache=TRUE,results='asis'}
#### VEHOWN
var.value.summary('VEHOWN',tab='veh')
```



```{r diag-164, cache=TRUE}
## VEHOWN
head(VEHOWN,10)
summary(VEHOWN[VEHOWN<7])
boxplot(VEHOWN,xlab=c("VEHOWN"))
boxplot(VEHOWN,xlab=c("Vehicle ownership"),col=c("gold"))
hist(VEHOWN,xlab=c("Vehicle ownership"),col=c("gold"))

## O_VEHOWN: Other, Vehicle ownership  
head(O_VEHOWN,10)
sum(is.na(O_VEHOWN)&VEHOWN==7)
```


Let us consider vehicle insurance:

```{r diag-summary-per-VEHINS,echo=FALSE,cache=TRUE,results='asis'}
#### VEHINS
var.value.summary('VEHINS',tab='veh')
```



```{r diag-165, cache=TRUE}
## VEHINS
head(VEHINS,10)
summary(VEHINS[VEHINS<8])
boxplot(VEHINS,xlab=c("VEHINS"))
```


```{r diag-summary-per-VEHOBD,echo=FALSE,cache=TRUE,results='asis'}
#### VEHOBD
var.value.summary('VEHOBD',tab='veh')
```



```{r diag-166, cache=TRUE}
## VEHOBD
head(VEHOBD,10)
summary(VEHOBD[VEHOBD<8])
boxplot(VEHOBD,xlab=c("VEHOBD"))
sum(is.na(VEHOBD)&!VEHINS==2,na.rm=T)
```


Other vehicle characteristics:


```{r diag-summary-per-VEHTRN,echo=FALSE,cache=TRUE,results='asis'}
#### VEHTRN
var.value.summary('VEHTRN',tab='veh')
```



```{r diag-167, cache=TRUE}
## VEHTRN
head(VEHTRN,10)
summary(VEHTRN[VEHTRN<8])
boxplot(VEHTRN,xlab=c("VEHTRN"))
sum(is.na(VEHTRN)&BODY<12)
SAMPN[is.na(VEHTRN)&BODY<12]
```


```{r diag-summary-per-VEHDRT,echo=FALSE,cache=TRUE,results='asis'}
#### VEHDRT
var.value.summary('VEHDRT',tab='veh')
```



```{r diag-168, cache=TRUE}
## VEHDRT
head(VEHDRT,10)
summary(VEHDRT[VEHDRT<8])
boxplot(VEHDRT,xlab=c("VEHDRT"))
hist(VEHDRT,xlab=c("Power train "),col=c("blue"))
sum(is.na(VEHDRT)&BODY<12)
SAMPN[is.na(VEHDRT)&BODY<12]
```


Now generate a pie chart for the VEHDRT variable:


```{r diag-169, cache=TRUE}
### Pie chart
vptable<-table(VEHDRT)
pct <- round(vptable/sum(vptable)*100)
lbls <- paste(pct,"%", sep="")
pie(vptable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of power train",cex=0.8)
legend("right",c("1","2","3","7","8","9"), cex=0.8, fill=rainbow(length(lbls)))
```


```{r diag-summary-per-O_VEHDRT,echo=FALSE,cache=TRUE,results='asis'}
#### O_VEHDRT
var.value.summary('O_VEHDRT',tab='veh',val.list=FALSE)
```



```{r diag-170, cache=TRUE}
## O_VEHDRT
head(O_VEHDRT,10)
sum(is.na(O_VEHDRT)&VEHDRT==7)
```


```{r diag-summary-per-VEHCYL,echo=FALSE,cache=TRUE,results='asis'}
#### VEHCYL
var.value.summary('VEHCYL',tab='veh')
```



```{r diag-171, cache=TRUE}
## VEHCYL: Cylinders  (1 to 7;97=other; 98=DK;99=RF)
head(VEHCYL,10)
summary(VEHCYL[VEHCYL<97])
boxplot(VEHCYL,xlab=c("Cylinders"),col=c("green"))
hist(VEHCYL[VEHCYL<97],xlab=c("Cylinders "),col=c("blue"))
sum(is.na(VEHCYL)&BODY<12)
SAMPN[is.na(VEHCYL)&BODY<12]
```


Let us create a pie chart for the VEHCYL variable:


```{r diag-172, cache=TRUE}
###Pie chart
rm(lbls,pct)
vctable<-table(VEHCYL)
pct <- round(vctable/sum(vctable)*100)
lbls <- paste(pct,"%", sep="")
pie(vctable,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of power train",cex=0.8)
legend("topright",c("1","2","3","7","97","98","99"), cex=0.8, fill=rainbow(length(lbls)))
```



```{r diag-summary-per-O_VEHCYL,echo=FALSE,cache=TRUE,results='asis'}
#### O_VEHCYL
var.value.summary('O_VEHCYL',tab='veh',val.list=FALSE)
```



```{r diag-173, cache=TRUE}
## O_VEHCYL: Cylinders, other  
head(O_VEHCYL,10)
sum(is.na(O_VEHCYL)&VEHCYL==97)
```


```{r diag-summary-per-VEHOUT,echo=FALSE,cache=TRUE,results='asis'}
#### VEHOUT
var.value.summary('VEHOUT',tab='veh')
```



```{r diag-174, cache=TRUE}
## VEHOUT
head(VEHOUT,10)
summary(VEHOUT[VEHOUT<9000])
boxplot(VEHOUT,xlab=c("Electric outlet"))
hist(VEHOUT,xlab=c("Electric outlets "),col=c("blue"))
```


```{r diag-summary-per-VEHVLT,echo=FALSE,cache=TRUE,results='asis'}
#### VEHVLT
var.value.summary('VEHVLT',tab='veh')
```



```{r diag-175, cache=TRUE}
## VEHVLT
head(VEHVLT,10)
summary(VEHVLT[VEHVLT<8])
boxplot(VEHVLT,xlab=c("VEHVLT"))
sum(is.na(VEHVLT)&VEHOUT<9000&VEHOUT>0,na.rm=T)
```



```{r diag-summary-per-VEHT,echo=FALSE,cache=TRUE,results='asis'}
#### VEHT
var.value.summary('VEHT',tab='veh')
```



```{r diag-176, cache=TRUE}
## VEHT
head(VEHT,10)
summary(VEHT[VEHT<9])
boxplot(VEHT,xlab=c("Vehicle type"))
hist(VEHT,xlab=c("Vehicle type "),col=c("blue"))
```


Let us also have a look at vehicle use variables.


```{r diag-summary-per-CNTV,echo=FALSE,cache=TRUE,results='asis'}
#### CNTV
var.value.summary('CNTV',tab='veh')
```



```{r diag-177, cache=TRUE}
## CNTV
head(CNTV,10)
summary(CNTV)
boxplot(CNTV,xlab=c("CNTV"))
hist(CNTV,xlab=c("Vehicle type "),col=c("blue"))
sum(is.na(CNTV))
```


```{r diag-summary-per-WYCNTV,echo=FALSE,cache=TRUE,results='asis'}
#### WYCNTV
var.value.summary('WYCNTV',tab='veh')
```



```{r diag-178, cache=TRUE}
## WYCNTV
head(WYCNTV,10)
summary(WYCNTV[WYCNTV<97])
boxplot(WYCNTV[WYCNTV<97],xlab=c("Reason why not"),col=c("green"))
hist(WYCNTV[WYCNTV<97],xlab=c("Reason why not "),col=c("blue"))
sum(is.na(WYCNTV)& !CNTV==1)
```



```{r diag-summary-per-HHWGT,echo=FALSE,cache=TRUE,results='asis'}
#### HHWGT
var.value.summary('HHWGT',tab='veh',val.list=FALSE)
```



```{r diag-179, cache=TRUE}
## HHWGT
head(HHWGT,10)
summary(HHWGT)
boxplot(HHWGT,xlab=c("Final household weight"),col=c("gold"))
sum(is.na(HHWGT))
SAMPN[is.na(HHWGT)]
VEHNO[is.na(HHWGT)]
```



```{r diag-summary-per-EXPHHWGT,echo=FALSE,cache=TRUE,results='asis'}
#### EXPHHWGT
var.value.summary('EXPHHWGT',tab='veh',val.list=FALSE)
```



```{r diag-180, cache=TRUE}
## EXPHHWGT
head(EXPHHWGT,10)
summary(EXPHHWGT)
boxplot(EXPHHWGT,xlab=c("EXPHHWGT"))
sum(is.na(EXPHHWGT))
SAMPN[is.na(EXPHHWGT)]
VEHNO[is.na(EXPHHWGT)]
```


We are done checking all the vehicle data variables. Let us detach the vehicle data frame:


```{r diag-181, cache=TRUE}
## Detach the data frame
detach(veh_data)
```



## Place Data

We follow the same steps to perform diagnostics for the place data. First we need to merge the place dataset and the dataset that contains location data.


```{r diag-182, cache=TRUE}
place_data <- chts_pla
lookup_place <- chts_lu_pla

# Check the dimension and names of variables
dim(place_data)
dim(lookup_place)
names(place_data)
names(lookup_place)
# Merge the two data set
place_data1<-merge(place_data,lookup_place, by =c("SAMPN","PERNO","PLANO"), all = TRUE)
# Dimension and names of variables
dim(place_data)
dim(lookup_per)
dim(place_data1)

# Names of the variables in the new dataset
names(place_data1)

```


Let us delete duplicate variables:


```{r diag-183, cache=TRUE}
# Subset the dataset (excluding the duplicate variables)
nplace_data<-subset(place_data1,select=-c(35,36,38:40,44:46))

# Dimension of the data frame
dim(nplace_data)

# show the existing variable names
names(nplace_data)

#rename the added variables
names(nplace_data) [c(47,48,49,52,53,55)] <- 
  c("PNAME","CITY","ZIP","CTFIP","TRACT","PPrimaryCity")

#names
names(nplace_data)
```


Now we have a new place data frame that contains location variables (x-y coordinates). We use this data frame for checking all the place level variables. Let us first attach this data frame:


```{r diag-184, cache=TRUE}
# Attach the data frame
attach(nplace_data)
```

Now, sort the data by sample number:

```{r diag-185, cache=TRUE}
# SAMPN: Sample number
# Sorting data by sample number
nplace_data<-nplace_data[order(SAMPN),] 
```

Let us check all the place level variables one by one just as for the other datasets.


```{r diag-summary-place-PERNO,echo=FALSE,cache=TRUE,results='asis'}
#### PERNO
var.value.summary('PERNO',tab='place',val.list=FALSE)
```



```{r diag-186, cache=TRUE}
## PERNO
### Show the first 10 observations 
head(PERNO,10)
###Summarize the variables
summary(PERNO)
###Check for missing observations
sum(PERNO=="")
sum(is.na(PERNO))
```

Now, create a boxplot for the person number variable:

```{r diag-187, cache=TRUE}
### Create boxplot  
boxplot(PERNO,xlab=c("PERNO"))
```

We follow the same procedure to check all the other variables.


```{r diag-summary-place-PLANO,echo=FALSE,cache=TRUE,results='asis'}
#### PLANO
var.value.summary('PLANO',tab='place',val.list=FALSE)
```



```{r diag-188, cache=TRUE}
## PLANO: Place number
head(PLANO,10)
summary(PLANO)
boxplot(PLANO,xlab=c("PLANO"))
sum(PLANO=="")
sum(is.na(PLANO))
```


```{r diag-summary-place-TOTTR,echo=FALSE,cache=TRUE,results='asis'}
#### TOTTR
var.value.summary('TOTTR',tab='place',val.list=FALSE)
```



```{r diag-189, cache=TRUE}
## TOTTR
head(TOTTR,10)
summary(TOTTR)
```

Generate a boxplot and histogram for the TOTTR variable:

```{r diag-190,cache=TRUE}
boxplot(TOTTR,xlab=c("Total people traveling on trip"),col=c("green"))
hist(TOTTR,xlab=c("Total people traveling on trip"),col=c("purple"))
```



```{r diag-summary-place-HHMEM,echo=FALSE,cache=TRUE,results='asis'}
#### HHMEM
var.value.summary('HHMEM',tab='place',val.list=FALSE)
```



```{r diag-191,cache=TRUE}
## HHMEM
head(HHMEM,10)
summary(HHMEM)
boxplot(HHMEM,xlab=c("Number of household members on trip"),col=c("gold"))
hist(HHMEM,xlab=c("Number of household members on trip"),col=c("maroon"))
```



### PER Variables

There are five variables for person number on trip. Let us look at them via summaries, boxplots, and histograms:

```{r diag-192,cache=TRUE}
## PER1
head(PER1,10)
summary(PER1)
boxplot(PER1,xlab=c("Person number on trip"),col=c("red"))
hist(PER1,xlab=c("Person number on trip"),col=c("orange"))

## PER2: Person number on trip
head(PER2,10)
summary(PER2)
boxplot(PER2,xlab=c("Person number on trip"),col=c("purple"))
hist(PER2,xlab=c("Person number on trip"),col=c("blue"))

## PER3: Person number on trip
head(PER3,10)
summary(PER3)
boxplot(PER3,xlab=c("Person number on trip"),col=c("yellow"))
hist(PER3,xlab=c("Person number on trip"),col=c("blue"))

## PER4: Person number on trip
head(PER4,10)
summary(PER4)
boxplot(PER4,xlab=c("Person number on trip"),col=c("green"))
hist(PER4,xlab=c("Person number on trip"),col=c("maroon"))

## PER5: Person number on trip
head(PER5,10)
summary(PER5)
boxplot(PER5,xlab=c("Person number on trip"),col=c("gold"))
hist(PER5,xlab=c("Person number on trip"),col=c("gold"))
```


```{r diag-summary-place-NONHH,echo=FALSE,cache=TRUE,results='asis'}
#### NONHH
var.value.summary('NONHH',tab='place',val.list=FALSE)
```


```{r diag-193,cache=TRUE}
## NONHH
head(NONHH,10)
summary(NONHH)
boxplot(NONHH,xlab=c("Number of non-household members on trip"),col=c("orange"))
hist(NONHH,xlab=c("Number of non-household members on trip"),col=c("red"))
```


Now consider the trip mode and parking variables.

```{r diag-summary-place-MODE,echo=FALSE,cache=TRUE,results='asis'}
#### MODE
var.value.summary('MODE',tab='place')
```



```{r diag-194,cache=TRUE}
## MODE
head(MODE,10)
summary(MODE)
boxplot(MODE,xlab=c("Mode of trip"),col=c("green"))
hist(MODE,xlab=c("Mode of trip"),col=c("orange"))
```


```{r diag-summary-place-VEHNO,echo=FALSE,cache=TRUE,results='asis'}
#### VEHNO
var.value.summary('VEHNO',tab='place',val.list=FALSE)
```

```{r diag-195,cache=TRUE}
## VEHNO
head(VEHNO,10)
summary(VEHNO[VEHNO<97])
boxplot( VEHNO,xlab=c("Household vehicle number used on trip"),col=c("yellow"))
hist(VEHNO[VEHNO<97],xlab=c("Household vehicle number used on trip"),col=c("blue"))
```



```{r diag-summary-place-DYGOV,echo=FALSE,cache=TRUE,results='asis'}
#### DYGOV
var.value.summary('DYGOV',tab='place')
```



```{r diag-197,cache=TRUE}
## DYGOV
head(DYGOV,10)
summary(DYGOV[DYGOV<8])
boxplot(DYGOV,xlab=c("DYGOV"))
```



```{r diag-summary-place-PRKTY,echo=FALSE,cache=TRUE,results='asis'}
#### PRKTY
var.value.summary('PRKTY',tab='place')
```



```{r diag-198, cache=TRUE}
## PRKTY
head(PRKTY,10)
summary(PRKTY[PRKTY<8])
boxplot(PRKTY,xlab=c("PRKTY"))

## O_PRKTY: Parking location type, other
head(O_PRKTY,10)
sum(is.na(O_PRKTY)&PRKTY==7)

## PXSTR: Parking location address
head(PXSTR,10)
```



```{r diag-summary-place-PRKMIN,echo=FALSE,cache=TRUE,results='asis'}
#### PRKMIN: Time walking from parking to destination (Range
var.value.summary('PRKMIN',tab='place')
```



```{r diag-199, cache=TRUE}
## PRKMIN
head(PRKMIN,10)
summary(PRKMIN[PRKMIN<98])
sd(PRKMIN[PRKMIN<98],na.rm=T)
boxplot(PRKMIN[PRKMIN<98],xlab=c("Time walking from parking to destination"),col=c("green"))
hist(PRKMIN[PRKMIN<98],xlab=c("Time walking from parking to destination"),col=c("orange"))
```



```{r diag-summary-place-PAYPK,echo=FALSE,cache=TRUE,results='asis'}
#### PAYPK
var.value.summary('PAYPK',tab='place')
```



```{r diag-200, cache=TRUE}
## PAYPK
head(PAYPK,10)
summary(PAYPK[PAYPK<8])
boxplot(PAYPK,xlab=c("PAYPK"))
```




```{r diag-summary-place-PKAMT,echo=FALSE,cache=TRUE,results='asis'}
#### PKAMT
var.value.summary('PKAMT',tab='place',val.list=FALSE)
```



```{r diag-201, cache=TRUE}
## PKAMT
PKAMT <- as.integer(PKAMT)
head(PKAMT,10)
summary(PKAMT[PKAMT<999])
sd(PKAMT[PKAMT<9998],na.rm=T)
boxplot(PKAMT,xlab=c("Parking amount"),col=c("gold"))
hist(PKAMT,xlab=c("Parking amount"),col=c("orange"))
```




```{r diag-summary-place-PKUNT,echo=FALSE,cache=TRUE,results='asis'}
#### PKUNT
var.value.summary('PKUNT',tab='place')
```



```{r diag-202, cache=TRUE}
## PKUNT
head(PKUNT,10)
summary(PKUNT[PKUNT<8])
boxplot(PKUNT,xlab=c("PKUNT"))
sum(is.na(PKUNT)&PAYPK==1,na.rm=T)
```




```{r diag-summary-place-PRKHW,echo=FALSE,cache=TRUE,results='asis'}
#### PRKHW
var.value.summary('PRKHW',tab='place')
```




```{r diag-203, cache=TRUE}
## PRKHW
head(PRKHW,10)
summary(PRKHW[PRKHW<7])
boxplot(PRKHW,xlab=c("PRKHW"))
sum(is.na(PRKHW)&PAYPK==1,na.rm=T)
## O_PRKHW: How did you pay for parking, other
head(O_PRKHW,10)
sum(is.na(O_PRKHW)&PRKHW==7)
```




```{r diag-summary-place-EMPARK,echo=FALSE,cache=TRUE,results='asis'}
#### EMPARK
var.value.summary('EMPARK',tab='place',val.list=FALSE)
```



```{r diag-204, cache=TRUE}
## EMPARK
EMPARK <- as.integer(EMPARK)
head(EMPARK,10)
summary(EMPARK[EMPARK<998])
boxplot(EMPARK,xlab=c("EMPARK"))
```




```{r diag-summary-place-TRANSYS,echo=FALSE,cache=TRUE,results='asis'}
#### TRANSYS
var.value.summary('TRANSYS',tab='place')
```



```{r diag-205, cache=TRUE}
## TRANSYS
head(TRANSYS,10)
summary(TRANSYS[TRANSYS<997])
boxplot(TRANSYS[TRANSYS<997],xlab=c("Transit system"),col=c("gold"))
hist(TRANSYS[TRANSYS<997],xlab=c("Transit system"),col=c("maroon"))
sum(is.na(TRANSYS)&MODE>15&MODE<28&!MODE==18,na.rm=T)

## O_TRANSYS: Transit system,other;
head(O_TRANSYS,10)
sum(is.na(O_TRANSYS)&TRANSYS==997)
```



```{r diag-summary-place-ROUTE,echo=FALSE,cache=TRUE,results='asis'}
#### ROUTE
var.value.summary('ROUTE',tab='place',val.list=FALSE)
```



```{r diag-206, cache=TRUE}
## ROUTE
head(ROUTE,10)
sum(is.na(ROUTE)&MODE>15&MODE<28&!MODE==18,na.rm=T)
SAMPN[is.na(ROUTE)&MODE>15&MODE<28&!MODE==18]
```


Now let us check various activity variables

```{r diag-summary-place-ACTCNT,echo=FALSE,cache=TRUE,results='asis'}
#### ACTCNT
var.value.summary('ACTCNT',tab='place',val.list=FALSE)
```



```{r diag-207, cache=TRUE}
## ACTCNT
head(ACTCNT,10)
summary(ACTCNT)
boxplot(ACTCNT,xlab=c("Number of activities"))
```



```{r diag-summary-place-ARR_HR,echo=FALSE,cache=TRUE,results='asis'}
#### ARR_HR
var.value.summary('ARR_HR',tab='place',val.list=FALSE)
```



```{r diag-208, cache=TRUE}
## ARR_HR
head(ARR_HR,10)
summary(ARR_HR)
boxplot(ARR_HR,xlab=c("Arrival time-hour"),col=c("green"))
hist(ARR_HR,xlab=c("Arrival time-hour"),col=c("purple"))
```



```{r diag-summary-place-ARR_MIN,echo=FALSE,cache=TRUE,results='asis'}
#### ARR_MIN
var.value.summary('ARR_MIN',tab='place',val.list=FALSE)
```



```{r diag-209, cache=TRUE}
## ARR_MIN
head(ARR_MIN,10)
summary(ARR_MIN)
boxplot(ARR_MIN,xlab=c("ARR_MIN"))
boxplot(ARR_MIN,xlab=c("Arrival time-minute"),col=c("gold"))
hist(ARR_MIN,xlab=c("Arrival time-minute"),col=c("maroon"))
```




```{r diag-summary-place-DEP_HR,echo=FALSE,cache=TRUE,results='asis'}
#### DEP_HR
var.value.summary('DEP_HR',tab='place',val.list=FALSE)
```




```{r diag-210, cache=TRUE}
## DEP_HR
head(DEP_HR,10)
summary(DEP_HR)
boxplot(DEP_HR,xlab=c("Departure time-hour"),col=c("brown"))
hist(DEP_HR,xlab=c("Departure time-hour"),col=c("gold"))
```



```{r diag-summary-place-DEP_MIN,echo=FALSE,cache=TRUE,results='asis'}
#### DEP_MIN
var.value.summary('DEP_MIN',tab='place',val.list=FALSE)
```



```{r diag-211, cache=TRUE}
## DEP_MIN
head(DEP_MIN,10)
summary(DEP_MIN)
boxplot(DEP_MIN,xlab=c("Departure time-minute"),col=c("green"))
hist(DEP_MIN,xlab=c("Departure time-minute"),col=c("purple"))
```



```{r diag-summary-place-TRIPDUR,echo=FALSE,cache=TRUE,results='asis'}
#### TRIPDUR
var.value.summary('TRIPDUR',tab='place',val.list=FALSE)
```



```{r diag-212, cache=TRUE}
## TRIPDUR
head(TRIPDUR,10)
summary(TRIPDUR)
sum(is.na(TRIPDUR)&PLANO>1)
boxplot(TRIPDUR,xlab=c("Travel time to place in minutes by walking"),col=c("yellow"))
```

Generate boxplots of trip duration for different trip distances

```{r diag-213, cache=TRUE}
boxplot(TRIPDUR,TRIPDUR[TripDistance<=50],TRIPDUR[TripDistance<=100],col=c("yellow"))
```

Here, we are generating boxplots of trip duration for different modes.

```{r diag-214, cache=TRUE}
boxplot(TRIPDUR[MODE==1],TRIPDUR[MODE==2],TRIPDUR[MODE==c(5,6)],
        TRIPDUR[MODE==c(12,15,19,22,23,24,25,26)],
        TRIPDUR[MODE==13],col=c("yellow"))
```

We can also generate a histogram of trip duration for trip distance less than 100 mile:

```{r diag-215, cache=TRUE}
hist(TRIPDUR[TripDistance<=100],xlab=c("Travel time to place in minutes"),col=c("green"))
```



```{r diag-summary-place-ACTDUR,echo=FALSE,cache=TRUE,results='asis'}
#### ACTDUR
var.value.summary('ACTDUR',tab='place',val.list=FALSE)
```



```{r diag-216, cache=TRUE}
## ACTDUR
head(ACTDUR,10)
summary(ACTDUR)
boxplot(ACTDUR[ACTDUR<10000],xlab=c("Activity duration at place in minutes"),col=c("green"))
hist(ACTDUR[ACTDUR<10000],xlab=c("Activity duration at place in minutes"),col=c("gold"))
boxplot(ACTDUR,xlab=c("ACTDUR"))
SAMPN[ACTDUR>15000]
```


It is also important to check the origin and destination location variables.


```{r diag-217, cache=TRUE}
attach(nplace_data)
head(PNAME,10) 
sum(is.na(PNAME))
SAMPN[is.na(PNAME)]

## CITY: City 
head(CITY,10)
sum(is.na(CITY))
SAMPN[is.na(CITY)]

## STATE: State
head(STATE,10)
sum(is.na(STATE))
SAMPN[is.na(STATE)]

## ZIP: Zip
summary(ZIP)
sum(is.na(ZIP))
SAMPN[is.na(ZIP)]

## oXCORD: Origin x-coordinate
head(oXCORD,10)
summary(oXCORD)
boxplot(oXCORD,xlab=c("oXCORD"))

## oYCORD: Origin y-coordinate
head(oYCORD,10)
summary(oYCORD)
boxplot(oYCORD,xlab=c("oYCORD"))

## dXCORD: Destination x-coordinate
head(dXCORD,10)
summary(dXCORD)
boxplot(dXCORD,xlab=c("dXCORD"))

## dYCORD: Destination y-coordinate
head(dYCORD,10)
summary(dYCORD)
boxplot(dYCORD,xlab=c("dYCORD"))
```


```{r diag-summary-place-TripDistance,echo=FALSE,cache=TRUE,results='asis'}
#### TripDistance
var.value.summary('TripDistance',tab='place',val.list=FALSE)
```



```{r diag-218, cache=TRUE}
## TripDistance
head(TripDistance,10)
summary(TripDistance)
boxplot(TripDistance,xlab=c("TripDistance"),col=("green"))
hist(TripDistance,xlab=c("TripDistance"),col=("green"))
```



```{r diag-summary-place-AirTripDistance,echo=FALSE,cache=TRUE,results='asis'}
#### AirTripDistance
var.value.summary('AirTripDistance',tab='place',val.list=FALSE)
```



```{r diag-219, cache=TRUE}
## AirTripDistance
head(AirTripDistance,10)
summary(AirTripDistance)
boxplot(AirTripDistance,xlab=c("AirTripDistance"))
```

Let us also analyze the trip location variables:

```{r diag-220, cache=TRUE}
## CTFIP: Trip location county FIP  Code 2010
head(CTFIP,10)
summary(CTFIP[CTFIP<999])

##TRACT: Trip location census tract ID 2010
head(TRACT,10)
summary(TRACT[TRACT<999999])

##PPrimaryCity: Trip location primary city
head(PPrimaryCity,10)

####PSTFIP: Trip location state fips code
head(PSTFIP,10)
summary(PSTFIP[PSTFIP<99])
```


Finally, let us have a look at the person-level weights

```{r diag-summary-place-PERWGT-2,echo=FALSE,cache=TRUE,results='asis'}
#### PERWGT
var.value.summary('PERWGT',tab='place',val.list=FALSE)
```



```{r diag-221, cache=TRUE}
## PERWGT
head(PERWGT,10)
summary(PERWGT)
boxplot(PERWGT,xlab=c("Final Person weight"),col=c("green"))
```



```{r diag-summary-place-EXPPERWGT,echo=FALSE,cache=TRUE,results='asis'}
#### EXPPERWGT
var.value.summary('EXPPERWGT',tab='place',val.list=FALSE)
```



```{r diag-222, cache=TRUE}
## EXPPERWGT
head(EXPPERWGT,10)
summary(EXPPERWGT)
boxplot(EXPPERWGT,xlab=c("Final expanded person weight"),col=c("gold"))
```



```{r diag-summary-place-TRIPNO,echo=FALSE,cache=TRUE,results='asis'}
#### TRIPNO
var.value.summary('TRIPNO',tab='place',val.list=FALSE)
```



```{r diag-223, cache=TRUE}
## TRIPNO
head(TRIPNO,10)
summary(TRIPNO)
boxplot(TRIPNO,xlab=c("TRIPNO"))
```



```{r diag-summary-place-TCF,echo=FALSE,cache=TRUE,results='asis'}
#### TCF
var.value.summary('TCF',tab='place',val.list=FALSE)
```



```{r diag-224, cache=TRUE}
## TCF
head(TCF,10)
summary(TCF)
boxplot(TCF,xlab=c("Trip correction factor"),col=c("gold"))
```



```{r diag-summary-place-TCFPERWGT,echo=FALSE,cache=TRUE,results='asis'}
#### TCFPERWGT
var.value.summary('TCFPERWGT',tab='place',val.list=FALSE)
```



```{r diag-225, cache=TRUE}
## TCFPERWGT
head(TCFPERWGT,10)
summary(TCFPERWGT)
boxplot(TCFPERWGT,xlab=c("Final trip weight"),col=c("yellow"))
```



```{r diag-summary-place-EXPTCFPERWGT,echo=FALSE,cache=TRUE,results='asis'}
#### EXPTCFPERWGT
var.value.summary('EXPTCFPERWGT',tab='place',val.list=FALSE)
```



```{r diag-226, cache=TRUE}
## EXPTCFPERWGT
head(EXPTCFPERWGT,10)
summary(EXPTCFPERWGT)
boxplot(EXPTCFPERWGT,xlab=c("EXPTCFPERWGT"))
```

We are done checking place level variables so we detach the place level data frame:

```{r diag-227, cache=TRUE}
## Detach the data frame
detach(nplace_data)
```



## Activity Data

Let us now check activity data variables. First we import the activity data frame, check its dimension, and list variable names:


```{r diag-228, cache=TRUE}
activity_data <- chts_act

# Dimension of the data file
dim(activity_data)

# show the existing variable names
names(activity_data)
```

Before starting to check variables, let us attach the data frame:

```{r diag-229, cache=TRUE}
# Attach the data frame
attach(activity_data)
```

Sort the data based on sample number:

```{r diag-230, cache=TRUE}
# SAMPN: Sample number
# Sorting data by sample number
activity_data<-activity_data[order(SAMPN),]
summary(SAMPN)
```

Now we are ready to start checking variables one by one using the same approach as above. 


```{r diag-summary-act-PERNO,echo=FALSE,cache=TRUE,results='asis'}
#### PERNO
var.value.summary('PERNO',tab='activity',val.list=FALSE)
```



```{r diag-231, cache=TRUE}
## PERNO
### Show the first 10 observations
head(PERNO,10)
###Summarize variables
summary(PERNO)
### Check for missing observations
sum(PERNO=="")
sum(is.na(PERNO))
### Create a boxplot  
boxplot(PERNO,xlab=c("PERNO"))
```



```{r diag-summary-act-PLANO,echo=FALSE,cache=TRUE,results='asis'}
#### PLANO
var.value.summary('PLANO',tab='activity',val.list=FALSE)
```



```{r diag-232, cache=TRUE}
## PLANO
head(PLANO,10)
summary(PLANO)
boxplot(PLANO,xlab=c("PLANO"))
sum(PLANO=="")
sum(is.na(PLANO))
```


```{r diag-summary-act-ACTNO,echo=FALSE,cache=TRUE,results='asis'}
#### ACTNO
var.value.summary('ACTNO',tab='activity',val.list=FALSE)
```



```{r diag-233, cache=TRUE}
## ACTNO
head(ACTNO,10)
summary(ACTNO)
boxplot(ACTNO,xlab=c("ACTNO"))
sum(ACTNO=="")
sum(is.na(ACTNO))
```



```{r diag-summary-act-ACTOTH,echo=FALSE,cache=TRUE,results='asis'}
#### ACTOTH
var.value.summary('ACTOTH',tab='activity')
```



```{r diag-234, cache=TRUE}
## ACTOTH
head(ACTOTH,10)
summary(ACTOTH[ACTOTH<8])
boxplot(ACTOTH,xlab=c("ACTOTH"))
```



```{r diag-summary-act-ACTHH,echo=FALSE,cache=TRUE,results='asis'}
#### ACTHH
var.value.summary('ACTHH',tab='activity',val.list=FALSE)
```



```{r diag-235, cache=TRUE}
## ACTHH
head(ACTHH,10)
summary(ACTHH)
boxplot(ACTHH,xlab=c(" Number of HH/family members in this activity"),col=c("green"))
hist(ACTHH,xlab=c(" Number of HH/family members in this activity"),col=c("orange"))
sum(is.na(ACTHH)&ACTOTH==1,na.rm=T)
sum(ACTHH>20,na.rm=T)
```



```{r diag-summary-act-ACTOR,echo=FALSE,cache=TRUE,results='asis'}
#### ACTOR
var.value.summary('ACTOR',tab='activity',val.list=FALSE)
```



```{r diag-236, cache=TRUE}
## ACTOR
head(ACTOR,10)
summary(ACTOR)
boxplot(ACTOR,xlab=c(" Number of other relatives in this activity"),col=c("yellow"))
hist(ACTOR,xlab=c(" Number of other relatives in this activity"),col=c("maroon"))
sum(!is.na(ACTOR)&!ACTOTH==1)
```



```{r diag-summary-act-ACTWK,echo=FALSE,cache=TRUE,results='asis'}
#### ACTWK
var.value.summary('ACTWK',tab='activity',val.list=FALSE)
```



```{r diag-237, cache=TRUE}
## ACTWK
head(ACTWK,10)
summary(ACTWK)
boxplot(ACTWK,xlab=c("ACTWK"))
boxplot(ACTWK,xlab=c(" Number of people from your work in this activity"),col=c("yellow"))
hist(ACTWK,xlab=c(" Number of people from your work in this activity"),col=c("green"))
sum(!is.na(ACTWK)&!ACTOTH==1)
```



```{r diag-summary-act-ACTSC,echo=FALSE,cache=TRUE,results='asis'}
#### ACTSC
var.value.summary('ACTSC',tab='activity',val.list=FALSE)
```



```{r diag-238, cache=TRUE}
## ACTSC
head(ACTSC,10)
summary(ACTSC)
boxplot(ACTSC,xlab=c("ACTSC"))
boxplot(ACTSC,xlab=c(" Number of people from your school in this activity"),col=c("red"))
hist(ACTSC,xlab=c("Number of people from your school in this activity"),col=c("blue"))
sum(!is.na(ACTSC)&!ACTOTH==1)
```



```{r diag-summary-act-ACTRG,echo=FALSE,cache=TRUE,results='asis'}
#### ACTRG
var.value.summary('ACTRG',tab='activity',val.list=FALSE)
```



```{r diag-239, cache=TRUE}
## ACTRG
head(ACTRG,10)
summary(ACTRG)
boxplot(ACTRG,
        xlab=c(" Number of people from same rel/social org in this activity"),
        col=c("red"))
hist(ACTRG,
     xlab=c("Number of people from same rel/social org in this activity"),
     col=c("gold"))
boxplot(ACTRG,xlab=c("ACTRG"))
sum(!is.na(ACTRG)&!ACTOTH==1)
```



```{r diag-summary-act-ACTFR,echo=FALSE,cache=TRUE,results='asis'}
#### ACTFR
var.value.summary('ACTFR',tab='activity',val.list=FALSE)
```



```{r diag-240, cache=TRUE}
## ACTFR
head(ACTFR,10)
summary(ACTFR)
boxplot(ACTFR,xlab=c(" Number of friends in this activity"),col=c("red"))
hist(ACTFR,xlab=c("Number of friends in this activity"),col=c("green"))
sum(!is.na(ACTFR)&!ACTOTH==1)
```



```{r diag-summary-act-ACTOT,echo=FALSE,cache=TRUE,results='asis'}
#### ACTOT
var.value.summary('ACTOT',tab='activity',val.list=FALSE)
```



```{r diag-241, cache=TRUE}
## ACTOT
head(ACTOT,10)
summary(ACTOT)
boxplot(ACTOT,xlab=c("Number of other relations in this activity"),col=c("red"))
hist(ACTOT,xlab=c("Number of other relations in this activity"),col=c("magenta"))
boxplot(ACTOT,xlab=c("ACTOT"))
sum(!is.na(ACTOT)&!ACTOTH==1)
```



```{r diag-summary-act-APURP,echo=FALSE,cache=TRUE,results='asis'}
#### APURP
var.value.summary('APURP',tab='activity')
```



```{r diag-242, cache=TRUE}
## APURP
head(APURP,10)
summary(APURP[APURP<99])
boxplot(APURP,xlab=c("Activity purpose"),col=c("red"))
hist(APURP,xlab=c("Activity purpose"),col=c("green"))

## O_APURP: Purpose, other
head(O_APURP,10)
sum(is.na(O_APURP)&APURP==38)
```

Let us check the start and end times of activities:

```{r diag-243, cache=TRUE}
## STIME: Start time
head(STIME,10)
sum(is.na(STIME))

## ETIME: End time
head(ETIME,10)
sum(is.na(ETIME))
```


We are done with activity data varaibles so let us detach the data frame:

```{r diag-250, cache=TRUE}
## Detach the data frame
detach(activity_data)
```




## Long Distance Travel Data

Finally, let us process the long distance dataset. As before, we load the data frame, rename it, load the data frame with location information, and merge them.


```{r diag-251, cache=TRUE}
LD_data <- chts_ld
lookup_LD <- chts_lu_ld

# Dimension of the data file
dim(LD_data)
dim(lookup_LD)

#Check variable names 
names(LD_data)
names(lookup_LD)
```


Merge the data frames:


```{r diag-252, cache=TRUE}
#Merging two data set
LD_data1<-merge(LD_data,lookup_LD, by =c("SAMPN", "LDNO"), all = TRUE)

# Dimension of the data frame
dim(LD_data)
dim(lookup_LD)
dim(LD_data1)

#Names of the variables in the new dataset
names(LD_data1)

# Subset the dataset to exclude duplicate variables
nLD_data<-subset(LD_data1,select=-c(6,8,10,11,13,15,17,18,47,48,52,54))

# Show variable names and dimension
dim(nLD_data)
names(nLD_data)

# Rename added variables
names(nLD_data) [c(44:52,55,58,59)] <- 
  c("LDOCITY","LDOZIP","LDOXCORD","LDOYCORD","LDDCITY","LDDZIP",
    "LDDXCORD","LDDYCORD","LDOCTFIP","LDDCTFIP","LDOPrimaryCity",
    "LDDPrimaryCity")

# Show variable names 
names(nLD_data)
```


Now attach the data frame and sort it based on sample number:


```{r diag-253, cache=TRUE}
# Attach the data frame
attach(nLD_data)

# SAMPN: Sample number
# Sorting data by sample number
nLD_data<-nLD_data[order(SAMPN),]
```


Now let us check each variable one by one:


```{r diag-summary-ld-LDNO,echo=FALSE,cache=TRUE,results='asis'}
#### LDNO
var.value.summary('LDNO',tab='ld',val.list=FALSE)
```



```{r diag-254, cache=TRUE}
## LDNO
### Show the first 11 observations 
head(LDNO,11)
###Summarize of the variable
summary(LDNO)
### Create boxplot  
boxplot(LDNO,xlab=c("LDNO"))
### Check missing observations
sum(LDNO=="")
sum(is.na(LDNO))
```


```{r diag-summary-ld-LDDAT,echo=FALSE,cache=TRUE,results='asis'}
#### LDDAT
var.value.summary('LDDAT',tab='ld',val.list=FALSE)
```



```{r diag-255, cache=TRUE}
## LDDAT
head(LDDAT,10)
summary(LDDAT)
sum(is.na(LDDAT))
```


### Origin Variables

Let us now work on variables related to trip origin location:


```{r diag-256, cache=TRUE}
attach(nLD_data)
## LDORG: Origin;(1 to 4;7=other;8=DK;9=RF)
head(LDORG)
summary(LDORG[LDORG<7])
boxplot(LDORG,xlab=c("LDORG"))
sum(LDORG=="")
sum(is.na(LDORG))
## LDOPNM: Origin place name
head(LDOPNM,10)
sum(is.na(LDOPNM)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7))
SAMPN[is.na(LDOPNM)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7)]
## LDOCITY: Origin city
head(LDOCITY,10)
sum(is.na(LDOCITY)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7))
SAMPN[is.na(LDOCITY)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7)]
## LDOZIP: Origin zip code
head(LDOZIP,10)
sum(is.na(LDOZIP)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7))
SAMPN[is.na(LDOZIP)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7)]
## LDOST: Origin state
head(LDOST,10)
sum(is.na(LDOST)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7))
SAMPN[is.na(LDOST)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7)]
## LDOCNTR: Origin country
head(LDOCNTR,10)
sum(is.na(LDOCNTR)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7))
SAMPN[is.na(LDOCNTR)&(LDORG==1|LDORG==2|LDORG==3|LDORG==4|LDORG==7)]
## LDOXCORD: Origin x-coordinates
head(LDOXCORD,10)
summary(LDOXCORD)
boxplot(LDOXCORD,xlab=c("LDOXCORD"))
## LDOYCORD: Origin y-coordinates
head(LDOYCORD,10)
summary(LDOYCORD)
boxplot(LDOYCORD,xlab=c("LDOYCORD"))
```


### Destination Variables

We are ready to consider variables related to destination location:


```{r diag-257, cache=TRUE}
## LDDPNM: Destination place name
head(LDDPNM,10)
sum(is.na(LDDPNM))

## LDDCITY: Destination city
head(LDDCITY,10)
sum(is.na(LDDCITY))

## LDDZIP: Destination zip code
summary(LDDZIP,na.rm=T)
sum(is.na(LDDZIP))

## LDDST: Destination state
head(LDDST,10)
sum(is.na(LDDST))

## LDDCNTR: Destination country
head(LDDCNTR,10)
sum(is.na(LDDCNTR))

## LDDXCORD: Destination x-coordinates
head(LDDXCORD,10)
summary(LDDXCORD)
boxplot(LDDXCORD,xlab=c("LDDXCORD"))

## LDDYCORD: Destination y-coordinates
head(LDDYCORD,10)
summary(LDDYCORD)
boxplot(LDDYCORD,xlab=c("LDDYCORD"))
```

```{r diag-summary-ld-LDTPURP,echo=FALSE,cache=TRUE,results='asis'}
#### LDTPURP
var.value.summary('LDTPURP',tab='ld')
```



```{r diag-258, cache=TRUE}
## LDTPURP
head(LDTPURP,10)
summary(LDTPURP[LDTPURP<97])
boxplot(LDTPURP,xlab=c("Long distance trip purpose"),col=c("green"))
hist(LDTPURP,xlab=c("Long distance trip purpose"),col=c("gold"))
sum(LDTPURP=="")
sum(is.na(LDTPURP))

## O_LDTPUPR: LD Trip Purpose,other
head(O_LDTPUPR,10)
sum(is.na(O_LDTPUPR)&LDTPURP==97)
```



```{r diag-summary-ld-LDWHO,echo=FALSE,cache=TRUE,results='asis'}
#### LDWHO
var.value.summary('LDWHO',tab='ld')
```



```{r diag-259, cache=TRUE}
## LDWHO
head(LDWHO,10)
summary(LDWHO[LDWHO<98])
sd(LDWHO[LDWHO<98],na.rm=T)
boxplot(LDWHO[LDWHO<98],xlab=c("People on trip"),col=c("yellow"))
hist(LDWHO[LDWHO<98],xlab=c("People on trip"),col=c("green"))
sum(LDWHO=="")
sum(is.na(LDWHO))
```



```{r diag-summary-ld-LDMHH,echo=FALSE,cache=TRUE,results='asis'}
#### LDMHH: Household members on trip
var.value.summary('LDMHH',tab='ld')
```



```{r diag-260, cache=TRUE}
## LDMHH
head(LDMHH,10)
summary(LDMHH[LDMHH<98])
boxplot(LDMHH[LDMHH<98],xlab=c("LDMHH"))
boxplot(LDMHH[LDMHH<98],xlab=c("Household members on trip"),col=c("green"))
hist(LDMHH[LDMHH<98],xlab=c("Household members on trip"),col=c("gold"))
sum(is.na(LDMHH)&(LDWHO>0&LDWHO<98))
```


There are eight variables related to persons on long distance trip. Let us examine them:


```{r diag-261, cache=TRUE}
## LDINI1: Person who made trip1
head(LDINI1,10)
summary(LDINI1[LDINI1<97])
boxplot(LDINI1,xlab=c("LDINI1"))
## LDINI2: Person who made trip2
head(LDINI2,10)
summary(LDINI2)
## LDINI3: Person who made trip3
head(LDINI3,10)
summary(LDINI3)
## LDINI4: Person who made trip4
head(LDINI4,10)
summary(LDINI4)
## LDINI5: Person who made trip5
head(LDINI5,10)
summary(LDINI5)
## LDINI6: Person who made trip6
head(LDINI6,10)
summary(LDINI6)
## LDINI7: Person who made trip7
head(LDINI7,10)
summary(LDINI7)
## LDINI8: Person who made trip8
head(LDINI8,10)
summary(LDINI8)
```

Now consider long distance mode:

```{r diag-summary-ld-LDMODE1,echo=FALSE,cache=TRUE,results='asis'}
#### LDMODE1
var.value.summary('LDMODE1',tab='ld')
```



```{r diag-262, cache=TRUE}
## LDMODE1
head(LDMODE1,10)
summary(LDMODE1[LDMODE1<99])
boxplot(LDMODE1,xlab=c("Long distance mode"),col=c("green"))
hist(LDMODE1[LDMODE1<98],xlab=c("Long distance mode"),col=c("gold"))
```



```{r diag-summary-ld-LDMODE2,echo=FALSE,cache=TRUE,results='asis'}
#### LDMODE2
var.value.summary('LDMODE2',tab='ld')
```


```{r diag-263, cache=TRUE}
## LDMODE2
head(LDMODE2,10)
summary(LDMODE2[LDMODE2<99])
boxplot(LDMODE2,xlab=c("Long distance mode"),col=c("maroon"))
hist(LDMODE2,xlab=c("Long distance mode"),col=c("green"))
```



```{r diag-summary-ld-LDMODE3,echo=FALSE,cache=TRUE,results='asis'}
#### LDMODE3
var.value.summary('LDMODE3',tab='ld')
```


```{r diag-264, cache=TRUE}
## LDMODE3
head(LDMODE3,10)
summary(LDMODE3)
```



```{r diag-summary-ld-LDMODE4,echo=FALSE,cache=TRUE,results='asis'}
#### LDMODE4
var.value.summary('LDMODE4',tab='ld')
```



```{r diag-265, cache=TRUE}
## LDMODE4
head(LDMODE4,10)
summary(LDMODE4)
```



```{r diag-summary-ld-MAXDATE,echo=FALSE,cache=TRUE,results='asis'}
#### MAXDATE
var.value.summary('MAXDATE',tab='ld',val.list=FALSE)
```



```{r diag-266, cache=TRUE}
## MAXDATE
head(MAXDATE,10)
summary(MAXDATE)
boxplot(MAXDATE,xlab=c("MAXDATE"))
```

Also check variables related to departure time, place, and modes:


```{r diag-summary-ld-LDTIM,echo=FALSE,cache=TRUE,results='asis'}
#### LDTIM
var.value.summary('LDTIM',tab='ld',val.list=FALSE)
```


```{r diag-267, cache=TRUE}
## LDTIM
head(LDTIM,10)
sum(is.na(LDTIM)&MAXDATE==1)
```

Here, we are checking variables related with departure place and modes:

```{r diag-268, cache=TRUE}
## LDDPPNM: Departure place name
head(LDDPPNM,10)

## LDDPMODE1: Departure mode;(1 to 29;99=DK/RF)
head(LDDPMODE1,10)
summary(LDDPMODE1[LDDPMODE1<99])
boxplot(LDDPMODE1,xlab=c("Departure mode"),col=c("orange"))
hist(LDDPMODE1,xlab=c("Departure mode"),col=c("brown"))
```


```{r diag-summary-ld-LDDPMODE2,echo=FALSE,cache=TRUE,results='asis'}
#### LDDPMODE2
var.value.summary('LDDPMODE2',tab='ld')
```



```{r diag-269, cache=TRUE}
## LDDPMODE2
head(LDDPMODE2,10)
summary(LDDPMODE2)
boxplot(LDDPMODE2,xlab=c("LDDPMODE2"))

## LDDPMODE3: Departure mode;(1 to 29;99=DK/RF)
head(LDDPMODE3,10)
summary(LDDPMODE3)

## LDDPMODE4: Departure mode;(1 to 29;99=DK/RF)
head(LDDPMODE4,10)
summary(LDDPMODE4)
```


Consider variables related to arrival place and modes.


```{r diag-270, cache=TRUE}
## LDARPNM: Arrival place name
head(LDARPNM,10)

## LDARMODE1: Arrival mode;(1 to 29;99=DK/RF)
head(LDARMODE1,10)
summary(LDARMODE1[LDARMODE1<99])
boxplot(LDARMODE1,xlab=c("Arrival mode"),col=c("yellow"))
hist(LDARMODE1,xlab=c("Arrival mode"),col=c("blue"))
```



```{r diag-summary-ld-LDARMODE2,echo=FALSE,cache=TRUE,results='asis'}
#### LDARMODE2
var.value.summary('LDARMODE2',tab='ld')
```



```{r diag-271, cache=TRUE}
## LDARMODE2
head(LDARMODE2,10)
summary(LDARMODE2[LDARMODE2<97])
boxplot(LDARMODE2,xlab=c("LDARMODE2"))

## LDARMODE3: Arrival  mode;(1 to 29;99=DK/RF)
head(LDARMODE3,10)
summary(LDARMODE3)

## LDARMODE4: Arrival  mode;(1 to 29;99=DK/RF)
head(LDARMODE4,10)
summary(LDARMODE4)
```


Now analyze long distance origin and destination location variables:


```{r diag-summary-ld-LDOCTFIP,echo=FALSE,cache=TRUE,results='asis'}
#### LDOCTFIP
var.value.summary('LDOCTFIP',tab='ld',val.list=FALSE)
```



```{r diag-272, cache=TRUE}
## LDOCTFIP
LDOCTFIP <- as.integer(LDOCTFIP)
head(LDOCTFIP,10)
summary(LDOCTFIP)
boxplot(LDOCTFIP,xlab=c("LDARMODE2"))
boxplot(LDOCTFIP,xlab=c("LDARMODE2"))
sum(is.na(LDOCTFIP))

## LDOCTRACT: LD trip origin location census tract ID 2010
head(LDOCTRACT,10)
summary(LDOCTRACT[LDOCTRACT<999999])
sum(is.na(LDOCTRACT))
```



```{r diag-summary-ld-LDDCTFIP,echo=FALSE,cache=TRUE,results='asis'}
#### LDDCTFIP
var.value.summary('LDDCTFIP',tab='ld',val.list=FALSE)
```



```{r diag-273, cache=TRUE}
## LDDCTFIP
LDDCTFIP <- as.integer(LDDCTFIP)
head(LDDCTFIP,10)
summary(LDDCTFIP[LDDCTFIP<99])
sum(is.na(LDDCTFIP))

## LDDCTRACT: LD trip destination location census tract ID 2010
head(LDDCTRACT,10)
summary(LDDCTRACT[LDDCTRACT<999999])
sum(is.na(LDDCTRACT))
```



```{r diag-summary-ld-ReturnHomeTripFlag,echo=FALSE,cache=TRUE,results='asis'}
#### ReturnHomeTripFlag
var.value.summary('ReturnHomeTripFlag',tab='ld')
```



```{r diag-274, cache=TRUE}
## ReturnHomeTripFlag
head(ReturnHomeTripFlag,10)
summary(ReturnHomeTripFlag)
```


We are done checking long distance variables so we can detach the data frame:


```{r diag-275, cache=TRUE}
## Detach the data frame
detach(nLD_data)
```

We are all done with generating summary statistics, boxplots, or histograms for variables in the CHTS.
